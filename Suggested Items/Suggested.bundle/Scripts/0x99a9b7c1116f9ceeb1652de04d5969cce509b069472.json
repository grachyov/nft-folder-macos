{
  "kind" : "js",
  "screensaverFileName" : "because.unless.until",
  "value" : "class t{constructor(t){this.useA=!1;let e=function(t){let e=parseInt(t.substr(0,8),16),i=parseInt(t.substr(8,8),16),s=parseInt(t.substr(16,8),16),n=parseInt(t.substr(24,8),16);return function(){e|=0,i|=0,s|=0,n|=0;let t=(e+i|0)+n|0;return n=n+1|0,e=i^i>>>9,i=s+(s<<3)|0,s=s<<21|s>>>11,s=s+t|0,(t>>>0)\/4294967296}};this.prngA=new e(t.hash.substr(2,32)),this.prngB=new e(t.hash.substr(34,32));for(let t=0;t<1e6;t+=2)this.prngA(),this.prngB()}random_dec(){return this.useA=!this.useA,this.useA?this.prngA():this.prngB()}random_num(t,e){return t+(e-t)*this.random_dec()}random_int(t,i){return e.floor(this.random_num(t,i+1))}random_bool(t){return this.random_dec()<t}}let e=Math,i=new t(tokenData);function s(t,e){return void 0===e&&(e=t,t=0),i.random_num(t,e)}function n(t,e){return void 0===e&&(e=t,t=0),i.random_int(t,e-1)}const a=(t=.5)=>i.random_bool(t),o=()=>a()?1:-1,h=(t,i,s)=>e.max(t,e.min(i,s));function r(t){return new Array(32).fill(null).map(((e,i)=>parseInt(t.hash.slice(2+2*i,4+2*i),16)))}const l=.25*e.PI,c=.5*e.PI,d=2*e.PI,u=[[-.218,.659],[-.462,-.575],[.234,.546],[-.566,.64],[.319,.536],[.244,-.566],[-.575,-.49],[-.199,-.679],[.263,-.002]],m=[0,1,2,3,4,5,6,8,10,16,17,21,23,24,29,30,36,38,40,41,42,48,52],f=[7,9,11,12,13,18,19,20,22,25,26,27,28,31,32,34,37,39,43,44,45,46,47,49,50],p=[5,7,10,17,31,36,37,38,40,42,44,46,47,48],g=[24,26,49],y=14,b=15,w=\/Headless\/i.test(navigator.userAgent),x=\/Android|webOS|iPhone|iPad|iPod|BlackBerry\/i.test(navigator.userAgent)||\/Android|webOS|iPhone|iPad|iPod|BlackBerry\/i.test(navigator.platform),A=[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"],k={1:[10],2:[],3:[5,10,15],4:[],5:[3,9],6:[],7:[10,17],8:[],9:[5,15],10:[1,3,7,11],11:[10,15],12:[],13:[],14:[],15:[3,9,11],16:[],17:[7]},v=[1,2,3,7,8,9,10,11,12,13,17];let M,S,O,z,C,T;const R=(t,e,i,s)=>{T=[0,1].includes(B)?2+n(3):[3].includes(B)?1+n(4):a(.1)?0:n(1,5),C=[];let o=k;if(C[0]=t||([0,1].includes(T)?v[n(v.length)]:n(1,18)),e)C[1]=e;else{let t;switch(T){case 0:case 1:t=[C[0]];break;default:t=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17].filter((t=>!C.includes(t)&&!o[C[0]].includes(t)))}C[1]=t[n(t.length)]}if(i)C[2]=i;else{let t;switch(T){case 0:case 1:case 2:case 3:t=[C[0]];break;default:t=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17].filter((t=>!C.includes(t)&&!o[C[0]].includes(t)&&!o[C[1]].includes(t)))}C[2]=t[n(t.length)]}if(s)C[3]=s;else{let t;switch(T){case 0:case 1:t=[C[0]];break;case 2:t=[C[1]];break;default:t=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17].filter((t=>!(C.includes(t)||o[C[0]].includes(t)||o[C[1]].includes(t)||o[C[2]].includes(t))))}C[3]=t[n(t.length)]}if(void 0===t&&void 0===e&&void 0===i&&void 0===s&&1===T){const t=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17].filter((t=>!C.includes(t)&&!k[C[0]].includes(t)));C[n(4)]=t[n(t.length)]}},E=s(100),B=E<13?0:E<21.5?1:E<37.5?2:E<49?3:E<62.5?4:E<76.5?5:E<86.5?6:7,D=n(0,7),I=n(0,9);R();const L=.2,_=[a(L),a(L),a(L),a(L),a(L),a(L),a(L)],F=n(7);_.some((t=>t))||(_[F]=!0);const P=n(12),Y=new Date(2020,P+1,0).getDate(),X=n(Y)+1,$=a(),W=a(),q=a(),G=a(),N=a(.2),H=!N&&a(),j=!N&&a(),U=!N&&(!(H||j)||a()),J=n(3),V=n(3),Q=n(3),Z=n(5),K=n(3),tt=n(5),et=(t,e)=>{if(!e)return[];const i=[...e];for(let t=i.length-1;t>0;t--){const e=~~(s(1)*(t+1));[i[t],i[e]]=[i[e],i[t]]}return i.slice(0,t)};function it(t){return t.length>1&&t.unshift(t.pop()),t}function st(t){return t.length>1&&t.push(t.shift()),t}const nt=t=>{for(let e=t.length-1;e>0;e--){const i=~~(s(1)*(e+1));[t[e],t[i]]=[t[i],t[e]]}return t},at=t=>Array.from({length:t+1},((t,e)=>e)),ot=(t,e,i,s)=>{const n=[];{const i=(e-t)\/(s-1);for(let e=0;e<s;e++){const s=t+e*i;n.push(s)}}return n},ht=t=>{if(t){const t=new Date(0);return new Date(6e4*t.getTimezoneOffset())}return new Date},rt=t=>{const e=ht(t);return[e.getDay(),e.getDate(),e.getMonth(),e.getFullYear()]},lt=()=>ht().getSeconds();let ct=0;const dt=()=>~~(.001*(performance.now()-ct)),ut=(t,e,i)=>{const s=ot(t,e,0,7);return nt(s)[ai]},mt=(t,e,i)=>{const s=ot(t,e,0,31);return nt(s)[oi-1]};let ft=[];const pt=(t,e,i,s)=>{let n=i||ft;for(let i=0;i<t;i++)n[i]=new Array(-1===e?t:e).fill(s)},gt=.0255,yt=(t,e,i,s)=>[gt*(100-t)*(100-s),gt*(100-e)*(100-s),gt*(100-i)*(100-s)],bt=function(t,e,i){let s=1-t\/255,n=1-e\/255,a=1-i\/255,o=Math.min(s,Math.min(n,a));return s=(s-o)\/(1-o),n=(n-o)\/(1-o),a=(a-o)\/(1-o),s=Math.round(1e4*s)\/100,n=Math.round(1e4*n)\/100,a=Math.round(1e4*a)\/100,o=Math.round(1e4*o)\/100,s=isNaN(s)?0:s,n=isNaN(n)?0:n,a=isNaN(a)?0:a,o=isNaN(o)?0:o,[s,n,a,o]},wt=(t,e,i)=>{t\/=255,e\/=255,i\/=255;let s=Math.min(t,e,i),n=Math.max(t,e,i),a=n-s,o=0,h=0,r=0;return o=0===a?0:n===t?(e-i)\/a%6:n===e?(i-t)\/a+2:(t-e)\/a+4,o=Math.round(60*o),o<0&&(o+=360),r=(n+s)\/2,h=0===a?0:a\/(1-Math.abs(2*r-1)),h=+(100*h).toFixed(1),r=+(100*r).toFixed(1),[o,h,r]},xt=(t,e,i)=>{e\/=100,i\/=100;let s=(1-Math.abs(2*i-1))*e,n=s*(1-Math.abs(t\/60%2-1)),a=i-s\/2,o=0,h=0,r=0;return 0<=t&&t<60?(o=s,h=n,r=0):60<=t&&t<120?(o=n,h=s,r=0):120<=t&&t<180?(o=0,h=s,r=n):180<=t&&t<240?(o=0,h=n,r=s):240<=t&&t<300?(o=n,h=0,r=s):300<=t&&t<360&&(o=s,h=0,r=n),o=Math.round(255*(o+a)),h=Math.round(255*(h+a)),r=Math.round(255*(r+a)),[o,h,r]},At=([t,e,i,s],[n,a,o,h],r)=>{const l=(n-t)\/(r-1),c=(a-e)\/(r-1),d=(o-i)\/(r-1),u=(h-s)\/(r-1),m=[[t,e,i,s]];for(let n=1;n<r-1;n++)m.push([~~(t+l*n),~~(e+c*n),~~(i+d*n),~~(s+u*n)]);return m.push([n,a,o,h]),m},kt=([t,e,i,s],n)=>{const[a,o,h]=yt(t,e,i,s),[r,l,c]=wt(a,o,h),[d,u,m]=xt((r+n)%360,l,c);return bt(d,u,m)},vt=([t,e,i],s)=>{const[n,a,o]=wt(t,e,i);return xt((n+s)%360,a,o)},Mt=t=>{const{dimX:e,dimY:i,memoryBuffer:s,view:a}=t.data;let o=0;for(let t=0;t<e;t++)for(let t=0;t<i;t++)a[o++]=n(2);postMessage({messageType:\"calc_done\",memoryBuffer:s,view:a},[s])};class St{constructor(t,e,i=Mt,s=Int8Array){this.calculated=!1,this.locked=!1,this.dataType=s,this.amem=[];for(let i=0;i<t;i++)this.amem[i]=i*e;this.memoryBuffer=new ArrayBuffer(t*e*this.dataType.BYTES_PER_ELEMENT),this.view=new this.dataType(this.memoryBuffer),this.viewMemo=[],this.workerUrl=URL.createObjectURL(new Blob([\"self.onmessage = \",i.toString()],{type:\"application\/javascript\"})),this.worker=new Worker(this.workerUrl),this.resolve=void 0,this.worker.onmessage=t=>{const{memoryBuffer:e,view:i,...s}=t.data;this.memoryBuffer=e,this.view=i,this.locked=!1,this.calculated=!0,this.viewMemo=new this.dataType(i),this.receiveUpdate(s),this.resolve()},this._dimX=t,this._dimY=e}receiveUpdate(t){}doWork(t){if(!this.locked&&0!==this.memoryBuffer.byteLength)return this.locked=!0,new Promise((e=>{this.resolve=e,this.worker.postMessage({dimX:this._dimX,dimY:this._dimY,framesElapsed:gn,memoryBuffer:this.memoryBuffer,view:this.view,...t},[this.memoryBuffer])}))}update(){}checkAnimationStateAt(t,e){return this.viewMemo[this.amem[t]+e]||0}isWithinBounds(t,e){return t>=0&&t<this._dimX&&e>=0&&e<this._dimY}}class Ot extends St{constructor(t,e,i){super(t,e,(t=>{const{dimX:e,dimY:i,memoryBuffer:s,view:n,framesElapsed:a,cycleLength:o,flyawayLength:h,elongation:r,diamondLength:l,mult:c,stepCount:d,remainingLength:u,quietLength:m,vertical:f,centerX:p,centerY:g}=t.data;t.data.timeForShutdown&&close();let y=0;const b=a+999,w=b%o-h,x=b%o>h,A=b%o>m;if(x||b%o>u||A){const t=~~(~~((A?b%o-m:l)*c)*(1\/d)*Math.min(e*r,i)\/2);for(let s=0;s<e;s++){let e=r*Math.abs(p-s-(x&&f?s<p?w:-w:0));for(let s=0;s<i;s++)n[y++]=+(e+Math.abs(g-s-(x?f?0:s<g?w:-w:0))<t)}}else for(let t=0;t<e;t++)for(let t=0;t<i;t++)n[y++]=0;postMessage({messageType:\"calc_done\",memoryBuffer:s,view:n},[s])})),this.vertical=i,this.elongation=this.vertical?s(.25,2):s(.5,3),this.cycleLength=a()?n(250,500):n(500,1e3);const o=n(~~(.1*this.cycleLength),~~(.5*this.cycleLength));this.remainingLength=this.cycleLength-o,this.flyawayLength=~~(.5*(this.cycleLength+this.remainingLength));const h=this.vertical?t:e;if(this.cycleLength-this.flyawayLength<h){let t=h-(this.cycleLength-this.flyawayLength);this.cycleLength+=t}this.diamondLength=n(~~(.1*this.remainingLength),~~(.9*this.remainingLength)),this.quietLength=this.remainingLength-this.diamondLength,this.stepCount=n(3,this.diamondLength);const r=a()?1:s(.25,1.5);this.mult=r*this.stepCount\/this.diamondLength,this.centerX=~~(.5*t),this.centerY=~~(.5*e)}doWork(){return super.doWork({cycleLength:this.cycleLength,flyawayLength:this.flyawayLength,elongation:this.elongation,diamondLength:this.diamondLength,mult:this.mult,stepCount:this.stepCount,remainingLength:this.remainingLength,quietLength:this.quietLength,vertical:this.vertical,centerX:this.centerX,centerY:this.centerY})}}class zt extends Ot{constructor(t,e){super(t,e,!1)}}class Ct extends Ot{constructor(t,e){super(t,e,!0)}}class Tt extends St{constructor(t,e,i=0,h=n(4,7),r=[!0,!1,a()][Ge[5]%3]){super(t,e,(t=>{const{dimX:e,dimY:i,memoryBuffer:s,view:n,framesElapsed:a,rainTangles:o,fallingShapes:h,freshGrid:r}=t.data;t.data.timeForShutdown&&close();const l=(t,e,...i)=>{let s=!1,n=!1;for(let d=i.length;d>-1;d-=2){let u=(a=t,o=e,h=i[d],r=i[d+1],l=i[(d+2)%i.length],c=i[(d+3)%i.length],(a-l)*(r-c)-(h-l)*(o-c));s=s||u<0,n=n||u>0}var a,o,h,r,l,c;return!s||!n};let c=0;h.forEach((t=>{let s=1e4,n=1e4,a=0,o=0;const h=t.corners.map((e=>[t.x+e[0]*i,t.y+e[1]*i]));h.forEach((([t,h])=>{t<s&&(s=Math.max(0,t)),h<n&&(n=Math.max(0,h)),t>a&&(a=Math.min(e-1,t)),h>o&&(o=Math.min(i-1,h))}));const c=h.flat();for(let t=~~s;t<a;t++)for(let e=~~n;e<o;e++)l(t,e,...c)&&r[t][e]++}));for(let t=0;t<e;t++)for(let e=0;e<i;e++)n[c++]=r[t][e];postMessage({messageType:\"calc_done\",memoryBuffer:s,view:n,rainTangles:o},[s])})),this._dimX=t,this._dimY=e;let l=n(4,7);this.fallingShapes=[],this.hellaIrregular=r,this.vmax=s(.5,2),this.wanderSize=(this.hellaIrregular,1);for(let t=i;t<i+l;t++){const e=.1+(this.hellaIrregular?.1:s(.05,.25)),i=[],n=s(d);for(let t=0;t<h;t++){const s=t\/h*d;i.push([Math.cos(s+n)*e,Math.sin(s+n)*e])}this.fallingShapes.push({x:~~((.8\/3*s(4)+s(.2))*this._dimX),y:~~(s(1)*this._dimY),vx:0,vy:0,radius:e,sides:h,corners:i,theta:s(d),rotationSpeed:(this.hellaIrregular?.002+5e-4*(t+1):s(.001,.008))*o()})}}receiveUpdate(t){this.rainTangles=t.rainTangles}update(){const t=gn+999;this.fallingShapes=this.fallingShapes.map((i=>{const n=i.theta+i.rotationSpeed*d*Math.sin(c*Math.sin(i.radius*t\/100)),a=i.x\/this._dimX,o=i.y\/this._dimY,r=1-e.abs(.5-a),l=1-e.abs(.5-o);return{...i,theta:n,x:h(0,Ds,i.x+i.vx),y:h(0,Is,i.y+i.vy),vx:h(-this.vmax,this.vmax,i.vx+(s(this.wanderSize)-this.wanderSize*(.45+.1*a))*(1+r)+.5*e.cos(n)),vy:h(-this.vmax,this.vmax,i.vy+(s(this.wanderSize)-this.wanderSize*(.45+.1*o))*(1+l)+.5*e.sin(c*e.sin(n))),corners:i.corners.map(((t,e)=>{const s=e\/i.sides*d,a=i.radius*(this.hellaIrregular?Math.sqrt(s)+Math.sin(c*Math.sin(1\/(1+Math.abs(i.theta))*(gn+10*s)\/60)):1);return[Math.cos(s+n)*a,Math.sin(s+n)*a]}))}}))}doWork(){const t=[];return pt(this._dimX,this._dimY,t,0),super.doWork({rainTangles:this.rainTangles,stackedRain:this.stackedRain,ascending:this.ascending,triangular:this.triangular,fallingShapes:this.fallingShapes,freshGrid:t})}}class Rt extends St{constructor(t,i){super(t,i,(t=>{const{dimX:e,dimY:i,memoryBuffer:s,view:n,framesElapsed:a,xmul:o,ymul:h,xmin:r,ymin:l,xminp:c,yminp:d,iter:u,branchyBailout:m,branchyRendering:f,branchyBailoutType:p,theta:g,showIterations:y,randomAdjust:b}=t.data;if(t.data.timeForShutdown)return void close();const w=(t,e)=>[t*t-e*e,2*t*e+.025*Math.sin(a*b*.25)],x=(t,e,i,s,n)=>{let a=e*h-l,u=t*o-r;[a,u]=[a*s-u*i,a*i+u*s],a-=d,u-=c;let g,y=a,b=u,x=!1;for(g=0;g<n&&!x;g++){[y,b]=w(y,b),y+=a,b+=u;let t=y*b;if(f)if(g<=2)x=!1;else switch(p){case 0:x=Math.abs(t)+Math.abs(Math.sin(t))<m;break;case 1:x=.1*Math.sin(Math.abs(y-b))<m;break;case 2:x=100*Math.atan(t)<m;break;case 3:x=Math.abs(y)+Math.sin(t+b)<m;break;case 4:x=t<m}else x=y*y+b*b>4}return[y,b,g,x]};let A=0;const k=Math.cos(g),v=Math.sin(g);for(let t=0;t<e;t++)for(let e=0;e<i;e++){const[i,s,a,o]=x(t,e,v,k,u);n[A++]=y?a:+(i*i+s*s<4&&!o)}postMessage({messageType:\"calc_done\",memoryBuffer:s,view:n},[s])})),this.branchyBailout=s(.002,.5),this.branchyBailoutType=a(.7)?0:n(1,5),this.branchyRendering=a(.6),this.changeEvery=n(50,200),this.showIterations=!0,this.maxIter=this.showIterations?0:20,this.zoomMin=.02,this.zoomMax=this.branchyRendering&&([2,3,4].includes(this.branchyBailoutType)||a(.25))?.4:.1,this.zoom=s(this.zoomMin,this.zoomMax),this.branchyRendering&&[2,3,4].includes(this.branchyBailoutType)&&(this.zoom=h(.2,.5,this.zoom)),this.xmul=4\/this._dimY,this.xmin=2*(this._dimX-this._dimX%2)\/this._dimY,this.ymul=4\/this._dimY,this.ymin=2,this.xmul*=this.zoom,this.ymul*=this.zoom,this.xmin*=this.zoom,this.ymin*=this.zoom,this.randomRatchet=s(.5,1.1),this.randomAngle=s(0,d),this.randomAngleDelta=s(.002,.004)*o(),this.raDeltaSpeed=s(.01,.07),this.thetaRatchet=s(.5,1.1),this.thetaDeltaSpeed=s(.001,.02-.25*this.raDeltaSpeed),this.thetaDelta=s(.003,.005)*o(),this.mainBulb=a(),this.theta=s(d),this.moving=!0,this.mainBulb?(this.yminp=.5*e.sin(this.randomAngle)-.25*e.cos(2*this.randomAngle),this.xminp=.5*e.cos(this.randomAngle)+.25*e.sin(2*this.randomAngle)):(this.yminp=1+.25*e.sin(this.randomAngle),this.xminp=.25*e.cos(this.randomAngle))}doWork(){if(!this.calculated&&gn%this.changeEvery==0||this.moving&&gn%4==0)return super.doWork({iter:15+2*this.maxIter,xmul:this.xmul,ymul:this.ymul,xmin:this.xmin,ymin:this.ymin,yminp:this.yminp,xminp:this.xminp,branchyRendering:this.branchyRendering,branchyBailout:this.branchyBailout,branchyBailoutType:this.branchyBailoutType,theta:this.theta,showIterations:this.showIterations,randomAdjust:this.randomAngleDelta})}update(){this.moving&&gn%4==0&&(this.theta+=this.thetaDelta*(this.thetaRatchet+e.sin(this.randomAngle+gn*this.thetaDeltaSpeed)),this.randomAngle+=this.randomAngleDelta*(this.randomRatchet+e.cos(this.theta+gn*this.raDeltaSpeed)),this.mainBulb?(this.yminp=.5*e.sin(this.randomAngle)-.25*e.cos(2*this.randomAngle),this.xminp=.5*e.cos(this.randomAngle)+.25*e.sin(2*this.randomAngle)):(this.yminp=1+.25*e.sin(this.randomAngle),this.xminp=.25*e.cos(this.randomAngle)))}}class Et extends Rt{}class Bt extends St{constructor(t,i,h,r=a(.6),l,c=!0){super(t,i,(t=>{const{dimX:e,dimY:i,memoryBuffer:s,view:n,framesElapsed:a,cx:o,cy:h,xmul:r,ymul:l,xmin:c,ymin:d,iter:u,branchyBailoutType:m,branchyBailout:f,branchyRendering:p,theta:g,xadd:y,yadd:b,showIterations:w,randomAdjust:x,shapeShift:A,_1_2_pi:k}=t.data;t.data.timeForShutdown&&close();const v=.25*Math.sin(a*x*.01),M=(t,e)=>[t*t-e*e,2*t*e+v],S=(t,e,i,s,n)=>{let a=o,u=h,g=e*l-d,w=t*r-c;A&&([g,w]=[g*s-w*i,g*i+w*s]),[g,w]=[g+y,w+b];let x,k=!1;for(x=0;x<n&&!k;x++){[g,w]=M(g,w),g+=a,w+=u;let t=g*w;if(p)if(x<=2)k=!1;else switch(m){case 0:k=Math.abs(t)+Math.abs(Math.sin(t))<f;break;case 1:k=.1*Math.sin(Math.abs(g-w))<f;break;case 2:k=100*Math.atan(t)<f;break;case 3:k=50*Math.asin(t+Math.abs(g-w))<f;break;case 4:k=t<f}else k=g*g+w*w>4}return[g,w,x,k]};let O=0;const z=Math.sin(k*Math.sin(g+k)),C=Math.sin(k*Math.sin(g));let T=[],R=0,E=1e9;for(let t=0;t<e;t++)for(let e=0;e<i;e++){const[i,s,n,a]=S(t,e,C,z,u);a&&n<E&&(E=n),T[R++]=w?n:+(i*i+s*s<4&&!a)}for(let t=0;t<T.length;t++)n[O++]=w&&T[t]<=E+6+u%4?-T[t]:T[t];postMessage({messageType:\"calc_done\",memoryBuffer:s,view:n},[s])})),this.branchyRendering=r,this.changeEvery=n(10,200),this.xminOffset=s(2)-1,this.yminOffset=s(2)-1,this.theta=s(d),this.thetaDelta=a()?0:s(.005),this.shapeShift=a(),l?(this.cx=l.cx,this.cy=l.cy,this.showIterations=l.showIterations,this.branchyBailoutType=l.branchyBailoutType):(this.branchyBailoutType=a(.7)?0:n(1,5),this.showIterations=a(.75),this.mainBulb=a(),this.randomAngle=s(3.5,5),this.mainBulb?(this.o=s(.5,.92),this.cy=this.o*e.sin(this.randomAngle)-.25*e.cos(2*this.randomAngle),this.cx=this.o*e.cos(this.randomAngle)+.25*e.sin(2*this.randomAngle)):(this.o=s(.25,.35),this.cy=1+this.o*e.sin(this.randomAngle),this.cx=this.o*e.cos(this.randomAngle)),c&&([this.cx,this.cy]=u[n(u.length)])),this.maxIter=this.showIterations?n(5,20):40,this.zoomMin=.16,this.zoomMax=.3,this.randomAngleDeltaRand=5*s(.06,.06\/this.zoomMin),this.randomAngleDeltaSign=o(),this.initZoom=s(this.zoomMin,this.zoomMax),this.zoom=.85*this.initZoom,this.xmul=4\/this._dimY,this.xmin=2*(this._dimX-this._dimX%2)\/this._dimY,this.ymul=4\/this._dimY,this.ymin=2,this.xmul*=this.zoom,this.ymul*=this.zoom,this.xmin*=this.zoom,this.ymin*=this.zoom,this.xmin+=this.xminOffset*this.zoom,this.ymin+=this.yminOffset*this.zoom,this.initBailoutMult=s(.01,h?.25:.5),this.bailout=this.zoom*this.initBailoutMult,this.xaddOffset=s(1)-.5,this.yaddOffset=s(1)-.5,this.randomAngleDelta=(e.max(this.randomAngleDeltaRand,.06\/this.zoom)-.1)*this.randomAngleDeltaSign*this.zoom*this.zoom,this.xadd=this.xmin*this.xaddOffset,this.yadd=this.ymin*this.yaddOffset,this.zoomRate=s(.001,.006),this.zoomRate2=s(.001,.006),this.moving=!0}doWork(){if(gn%4==0)return super.doWork({iter:this.showIterations?10+2*this.maxIter:~~(10+this.maxIter*(1+e.sin(1.5*Math.PI+.1*gn\/this.changeEvery))),cx:this.cx,cy:this.cy,xmul:this.xmul,ymul:this.ymul,xmin:this.xmin,ymin:this.ymin,branchyRendering:this.branchyRendering,branchyBailout:this.bailout,branchyBailoutType:this.branchyBailoutType,theta:this.theta,xadd:this.xadd,yadd:this.yadd,showIterations:this.showIterations,randomAdjust:this.randomAngleDelta,shapeShift:this.shapeShift,_1_2_pi:c})}update(){gn%4==0&&this.moving&&(this.zoom=this.initZoom*(.85+.25*(e.sin(c*e.sin(gn*this.zoomRate))+e.sin(c*e.sin(e.PI+gn*this.zoomRate2)))),this.xmul=4\/this._dimY,this.xmin=2*(this._dimX-this._dimX%2)\/this._dimY,this.ymul=4\/this._dimY,this.ymin=2,this.xmul*=this.zoom,this.ymul*=this.zoom,this.xmin*=this.zoom,this.ymin*=this.zoom,this.xmin+=this.xminOffset*this.zoom,this.ymin+=this.yminOffset*this.zoom,this.bailout=this.zoom*this.initBailoutMult,this.randomAngleDelta=(e.max(this.randomAngleDeltaRand,.06\/this.zoom)-.1)*this.randomAngleDeltaSign*this.zoom*this.zoom,this.xadd=this.xmin*this.xaddOffset,this.yadd=this.ymin*this.yaddOffset)}}class Dt extends Bt{}class It extends St{constructor(t,e){super(t,e,(t=>{let{dimX:e,dimY:i,memoryBuffer:s,view:n,framesElapsed:a,cAdd:o,dAdd:h,inversionRadius:r,colorType:l,rOffset:c,speed:d,zoom:u,flip:m,flip2:f,flip3:p,withSpiral:g,case2mult:y,spiralPower:b,spiralMultiplier:w,wild:x,warpThetaMult:A,warpRMult:k,radiusWarpSpeed:v,absC:M,absD:S,_1_2_pi:O,_2_pi:z}=t.data;t.data.timeForShutdown&&close();const C=(t,e)=>[t*Math.cos(e),(f^p?-1:1)*t*Math.sin(e)],T=r*r,R=(0===l?20:.5)*(1.1+Math.sin(a\/d)),E=1\/R;let B=Math.min(e,i);const D=u*(1\/B),I=z\/i,L=z\/e,_=.5*e,F=.5*i;let P=w*(.5+Math.sin(O*Math.sin(.01*a))),Y=O+a*(v||.015),X=w*(2.5+2*Math.sin(O*Math.sin(Y))),$=0;const W=k\/u,q=(3===m?X:1)*T;for(let t=0;t<e;t++)for(let s=0;s<i;s++){let i=D*(t-_)+o,a=D*(s-F)+h;switch(0===a&&(a=1e-6),0===i&&(i=1e-6),p&&([i,a]=[a,i]),m){case 1:[i,a]=[i*a,i*i-a];break;case 2:[i,a]=[i*y*Math.sin(I*a),a*y*Math.cos(L*i)];break;case 3:[i,a]=[M?Math.abs(i):i,S?Math.abs(a):a]}let r,d,[u,w]=[((G=i)*G+(N=a)*N)**.5,G>0?Math.atan(N\/G):Math.atan(N\/G)+Math.PI];if([r,d]=x?C(u,w+c+u):0===m?C(u,w+c+(P+(p?e-t:t)**A*u*W)*u**b):C(q\/u,w+c+(g?u**b*P:0)),0===m)n[$++]=E*Math.abs(f?B*r+_:B*d+F);else if(0===l){const t=f?B*r+_:B*d+F;n[$++]=3===m?t:Math.abs(t)}else n[$++]=2*(1+Math.sin(R*(f?B*r+_:B*d+F)))}var G,N;postMessage({messageType:\"calc_done\",memoryBuffer:s,view:n},[s])}),Float32Array),this.zoom=s(.7,3),this.inversionRadius=s(.1,.3),this.flip=n(4),this.flip2=a(),this.flip3=a(),this.rOffset=s(d),this.speed=n(500,3e3),this.colorType=n(2),this.withSpiral=a(),this.spiralMultiplier=4;let i=a(.2)?0:s(.3),o=s(d);this.cAdd=this.zoom*i*Math.cos(o),this.dAdd=this.zoom*i*Math.sin(o),this.spiralPower=s(.5,2),this.warpThetaMult=0,this.warpRMult=0}doWork(){return super.doWork({inversionRadius:this.inversionRadius,colorType:this.colorType,rOffset:this.rOffset,speed:this.speed,zoom:this.zoom,flip:this.flip,flip2:this.flip2,flip3:this.flip3,case2mult:this.case2mult,cAdd:this.cAdd,dAdd:this.dAdd,withSpiral:this.withSpiral,spiralPower:this.spiralPower,spiralMultiplier:this.spiralMultiplier,wild:this.wild,warpThetaMult:this.warpThetaMult,warpRMult:this.warpRMult,radiusWarpSpeed:this.radiusWarpSpeed,absC:this.absC,absD:this.absD,_1_2_pi:c,_2_pi:d})}}class Lt extends It{}class _t extends It{constructor(t,e,i=.2,n=s(d)){super(t,e),this.flip=0,this.withSpiral=!0,this.spiralMultiplier=s(.7,9),this.zoom=s(.5,1.5),this.inversionRadius=.1,this.speed=1\/s(.001,.005),this.spiralPower=s(.5,2),this.flip2=a(),this.flip3=a(),this.rotationSpeed=a()?0:s(0,.025)-.0125,this.colorType=0,this.rOffset=s(d);let o=i,h=n;this.radius=o,this.theta=h,this.cAdd=this.zoom*o*Math.cos(h),this.dAdd=this.zoom*o*Math.sin(h),this.warpThetaMult=a(.4)?0:s(.8,1.8),this.warpRMult=a(.4)?0:s(0,.004)}update(){this.rOffset+=this.rotationSpeed}}class Ft extends It{constructor(t,e){super(t,e),this.flip=0,this.withSpiral=a(),this.cAdd=0,this.dAdd=0,this.flip2=a(),this.flip3=a(),this.wild=!0,this.spiralMultiplier=2,this.speed=n(18e3,35e3);const i=a()?.008:5e-4,o=a()?.05:.011;this.zoom=a()?s(i,o):1\/s(1\/o,1\/i),this.inversionRadius=s(.1,.2),this.rotationSpeed=2.5*(s(1e-4,.001)-5e-4),this.rOffset=a()||Ge[4]%2==0?s(d):n(8)*l,this.colorType=Ge[5]%2,this.colorType||(this.zoom*=20,this.speed*=.1)}update(){gn%4==0&&(this.rOffset+=this.rotationSpeed)}}class Pt extends It{constructor(t,e){super(t,e),this.flip=1,this.zoom=s(1,5),this.inversionRadius=s(.15,.3),this.flip2=a(),this.flip3=a(),this.rOffset=s(d),this.initialSpeed=500,this.speed=this.initialSpeed,this.colorType=1,this.withSpiral=a(),this.radius=a(.3)?0:s(0,.25),this.theta=s(d),this.cAdd=this.zoom*this.radius*Math.cos(this.theta),this.dAdd=this.zoom*this.radius*Math.sin(this.theta),this.spiralPower=s(.5,1.5),this.spiralChange=1\/n(10,1e3),this.rotationSpeed=0,this.zoomin=!0,this.zoomAmt=.008,this.timeToChill=n(15,60),this.zoomCtr=lt()-(this.timeToChill+1)}update(){lt()-this.zoomCtr>this.timeToChill&&gn%4==0?(this.speed=5e4,this.zoomin&&this.zoom<.5?(this.speed=this.initialSpeed,this.zoomin=!1,this.zoomCtr=lt()):!this.zoomin&&this.zoom>10&&(this.speed=this.initialSpeed,this.zoomin=!0,this.zoomCtr=lt()),this.zoom*=this.zoomin?1-this.zoomAmt:1+this.zoomAmt):this.spiralPower=h(.5,1.5,this.spiralPower+this.flip3?0:this.spiralChange*(this.zoomin^this.flip2?1:-1)),this.cAdd=this.zoom*this.radius*Math.cos(this.theta),this.dAdd=this.zoom*this.radius*Math.sin(this.theta),this.zoomCtr++}}class Yt extends It{constructor(t,e){super(t,e),this.flip=2,this.case2canonA=.6,this.case2canonB=5,this.case2mult=s(this.case2canonA,this.case2canonB),this.zoom=s(.4,2),this.inversionRadius=s(.1,.5),this.flip2=a(),this.flip3=a(),this.speed=n(500,15e3),this.colorType=1,this.withSpiral=a(),this.rOffset=3;let i=a(.2)?0:a(.2)?s(.7):s(1.7),o=s(d);this.cAdd=this.zoom*i*Math.cos(o),this.dAdd=this.zoom*i*Math.sin(o)}}class Xt extends It{constructor(t,e){super(t,e),this.flip=3,this.withSpiral=a(),this.inversionRadius=1\/s(4,1\/.19),this.rotationSpeed=s(.005,.03),this.colorType=Ge[8]%2,this.spiralMultiplier=s(.1,.5),this.speed=1e3,this.radiusWarpSpeed=s(.005,.01),this.absC=a(.25),this.absD=a(.25),this.zoom=1\/s(.2,.8)}update(){gn%4==0&&(this.rOffset+=this.rotationSpeed)}}class $t extends St{constructor(t,e,i){super(t,e,(t=>{const{dimX:e,dimY:i,memoryBuffer:s,view:n,framesElapsed:a,ca:o,sizeRatio:h}=t.data;t.data.timeForShutdown&&close();let r=0;for(let t=0;t<e;t++)for(let e=0;e<i;e++){let i=~~(e*h);i<0&&(i=0);let s=~~(t*h);s<0&&(s=0),n[r++]=+o[i][s]}postMessage({messageType:\"calc_done\",memoryBuffer:s,view:n},[s])})),this.withSymmetry=Ge[10]%3==2?a():!!(Ge[10]%3),this.fixedRandmirProb=a(),this.fProb=s(.25,.75),this.reverseRandmirProb=a(),this.reflectin=Li;const o=Ge[2]%2!=0||i?n:s;this.sizeRatio=1\/(i?o(8,12):o(6,20)),this.clearSize=Ge[14]%3==0?s(.1,.35):Ge[13]>128?0:.1+Ge[13]\/512;const h=~~(t*this.sizeRatio);this.cellCountX=h+1,this.aMax=~~(this.cellCountX-this.clearSize*~~(this.cellCountX\/2)-1),this.aMin=~~(this.clearSize*(1+~~(this.cellCountX\/2)));const r=~~(e*this.sizeRatio);this.cellCountY=r+1,this.bMax=~~(this.cellCountY-this.clearSize*~~(this.cellCountY\/2)-1),this.bMin=~~(this.clearSize*(1+~~(this.cellCountY\/2))),this.ca=[],this.nextGrid=[];const l=[];let c,d;dn>1?(c=Ke[yi],d=~~(c\/dn)):(d=Ke[yi],c=~~(d*dn));const u=1+~~(c\/6),m=1+~~(d\/6);pt(this.cellCountY,this.cellCountX,this.ca),pt(this.cellCountY,this.cellCountX,this.nextGrid),pt(1+~~(m\/2),1+~~(u\/2),l);for(let t=0;t<1+~~(m\/2);t++)for(let e=0;e<1+~~(u\/2);e++){let i=this.fixedRandmirProb?this.fProb:this.fProb*t\/(1+~~(this.cellCountY\/2));this.reverseRandmirProb&&(i=1-i),l[t][e]=a(i)?0:1}for(let t=0;t<1+~~(this.cellCountY\/2);t++)for(let e=0;e<1+~~(this.cellCountX\/2);e++)t<this.clearSize*~~(this.cellCountY\/2)-1||e<this.clearSize*~~(this.cellCountX\/2)-1?this.ca[t][e]=0:this.ca[t][e]=l[t][e];if(this.reflectin){for(let t=0;t<1+~~(this.cellCountY\/2);t++)for(let e=~~(this.cellCountX\/2);e<this.cellCountX;e++)this.ca[t][e]=this.ca[t][this.cellCountX-e-1];for(let t=1+~~(this.cellCountY\/2);t<this.cellCountY;t++)for(let e=0;e<this.cellCountX;e++)this.ca[t][e]=this.ca[this.cellCountY-t-1][e]}else{for(let t=~~(this.cellCountY\/2);t<this.cellCountY;t++)for(let e=~~(this.cellCountX\/2);e<this.cellCountX;e++)this.ca[t][e]=this.ca[this.cellCountY-t-1][this.cellCountX-e-1];for(let t=1+~~(this.cellCountY\/2);t<this.cellCountY;t++)for(let e=0;e<~~(this.cellCountX\/2);e++)this.ca[t][e]=this.ca[t][~~(this.cellCountX\/2)+e+1];for(let t=0;t<~~(this.cellCountY\/2);t++)for(let e=1+~~(this.cellCountX\/2);e<this.cellCountX;e++)this.ca[t][e]=this.ca[this.cellCountY-t-1][this.cellCountX-e-1]}this.selectedAutomata=n(i?5:7),this.updateFrequency=n(16,i?64:84),this.changeChance=.1*(0===this.selectedAutomata?.25:1)\/(1e3*this.sizeRatio**.5),this.dimChangeChance=1-(1-this.changeChance)**(this.cellCountX*this.cellCountY),this.fourOrFive=a()?4:5,this.fiveOrSix=a()?5:6,this.twoOrThree=a()?2:3}doWork(){return super.doWork({ca:this.ca,sizeRatio:this.sizeRatio})}update(){if((gn+999)%this.updateFrequency<7*this.updateFrequency\/8)return;let t,e,i=0;if(a(this.dimChangeChance)&&(t=[n(this.cellCountX),n(this.cellCountY)],this.withSymmetry)){const i=this.reflectin?t[1]:this.cellCountY-t[1]-1;e=[this.cellCountX-t[0]-1,i]}for(let s=0;s<this.cellCountY;s++)for(let n=0;n<this.cellCountX;n++){let a=0;for(let t=-1;t<=1;t++)for(let e=-1;e<=1;e++){if(!e&&!t)continue;let i=s+t,o=n+e;i<0||i>=this.cellCountY||o<0||o>=this.cellCountX||(a+=this.ca[i][o])}switch(i+=a,this.selectedAutomata){case 0:this.nextGrid[s][n]=this.ca[s][n]&&[2,3,4].includes(a)||!this.ca[s][n]&&[3].includes(a);break;case 1:this.nextGrid[s][n]=this.ca[s][n]&&[1,2,3,4,this.fourOrFive].includes(a)||!this.ca[s][n]&&[3,7].includes(a);break;case 2:this.nextGrid[s][n]=this.ca[s][n]&&a>1&&a<this.fiveOrSix||!this.ca[s][n]&&3===a;break;case 3:this.nextGrid[s][n]=this.ca[s][n]&&9!==a||!this.ca[s][n]&&[3].includes(a);break;case 4:this.nextGrid[s][n]=this.ca[s][n]&&[1,3,4,5,6,7].includes(a)||!this.ca[s][n]&&[1].includes(a);break;case 5:this.nextGrid[s][n]=this.ca[s][n]&&!(a<2||5===a)||!this.ca[s][n]&&3===a||a>6;break;case 6:this.nextGrid[s][n]=this.ca[s][n]&&[this.twoOrThree,4,5,6].includes(a)||!this.ca[s][n]&&[3,4].includes(a)}(t&&t[0]===n&&t[1]===s||e&&e[0]===n&&e[1]===s)&&(this.nextGrid[s][n]=!this.nextGrid[s][n]),(s<this.bMin||n<this.aMin||s>this.bMax||n>this.aMax)&&(this.nextGrid[s][n]=0)}if(i<3)for(let t=0;t<this.cellCountY;t++)for(let e=0;e<this.cellCountX;e++)t<this.bMin||e<this.aMin||t>this.bMax||e>this.aMax?this.nextGrid[t][e]=0:this.nextGrid[t][e]=a();[this.ca,this.nextGrid]=[this.nextGrid,this.ca]}}const Wt=[zt,Ct,Tt,Et,Dt,Lt,Ft,_t,Pt,Yt,Xt,$t];class qt{constructor(t){this.chosenAnimationIndexes=t||[n(Wt.length)],this.animationClasses=this.chosenAnimationIndexes.map((t=>Wt[t]));const e=[11,13,16,17,19,23,25,29],i=et(4,e),s=et(4,e.filter((t=>!i.includes(t))));this.timeToWait=[i,s];const a=at(52).filter((t=>![y,b].includes(t)));this.thursdayAcceptableAutos=[[...et(15,a)],[...et(15,a),14,15],[...et(15,a),14,15],[...et(15,a),14]],this.thursdayBgAutos=[[...et(15,a)],[...et(15,a),15],[...et(15,a),14,15],[...et(15,a),15]],this.saturdayAcceptableAutos=[[...et(15,[...Array(15).fill(y),...Array(15).fill(b)])],[...et(15,[...Array(15).fill(y),...Array(15).fill(b)])],[...et(15,[...Array(15).fill(y),...Array(15).fill(b)])],[...et(15,[...Array(15).fill(y),...Array(15).fill(b)])]],this.saturdayAcceptableBgAutos=[[...et(15,[...Array(15).fill(y),...Array(15).fill(b)])],[...et(15,[...Array(15).fill(y),...Array(15).fill(b)])],[...et(15,[...Array(15).fill(y),...Array(15).fill(b)])],[...et(15,[...Array(15).fill(y),...Array(15).fill(b)])]]}async teardown(t){t&&t.forEach((t=>{t.worker?.postMessage({timeForShutdown:!0})}))}initAutomata(){this.initThursdayAutomata()}initThursdayAutomata(){We=this.thursdayAcceptableAutos.map(((t,e)=>t.slice(t.length-We[e].length))),qe=this.thursdayBgAutos.map(((t,e)=>t.slice(t.length-qe[e].length)))}initSaturdayAutomata(){We=this.saturdayAcceptableAutos.map(((t,e)=>t.slice(t.length-We[e].length))),qe=this.saturdayAcceptableBgAutos.map(((t,e)=>t.slice(t.length-qe[e].length)))}primeAutomata(){ke=[],ve=[],xe=[void 0,void 0,void 0,void 0],Ae=[void 0,void 0,void 0,void 0],vi?this.initThursdayAutomata():Si&&this.initSaturdayAutomata();for(let t=0;t<2;t++)for(let e=0;e<4;e++)this.updateAutoModes(e,!!t)}genEnsureAutoRands(){this.ensureAutoRands=[[...at(19).map((t=>n(4)))],[...at(19).map((t=>n(4)))]]}ensureAutomataBalance(){let t=0;for(;(!(ke.some((e=>[y].includes(e)&&gn>=10||[b,9].includes(e)&&(this.ensureAutoRands[0][t]<2||gn<10)))||ke.some((t=>m.includes(t)))&&ke.some((t=>f.includes(t)))&&gn>=10)||(ke.filter((t=>[9,b].includes(t))).length>1||ke.filter((t=>t===y)).length>2)&&!Si)&&t++<19;)si.updateAutoModes(this.ensureAutoRands[0][t],!1);for(t=0;(!(ve.some((e=>[y].includes(e)&&gn>=10||[b,9].includes(e)&&(this.ensureAutoRands[1][t]<2||gn<10)))||ve.some((t=>m.includes(t)))&&ve.some((t=>f.includes(t)))&&gn>=10)||(ve.filter((t=>[9,b].includes(t))).length>1||ve.filter((t=>t===y)).length>2)&&!Si)&&t++<19;)si.updateAutoModes(this.ensureAutoRands[1][t],!0)}initAnimations(t,e){const i=this.animations;this.animations=void 0,this.teardown(i),this.animations=this.animationClasses.map((i=>new i(t,e)))}async updateAnimations(){this.animations.forEach((t=>{t.update()})),Se||!gn?(await Promise.all(this.animations.map((t=>t.doWork()))),this.animationsExecutedAtLeastOnce=!0):this.animations.forEach((t=>{t.doWork()}))}updateAutoModes(t,e){if((e?Ae:xe)[t]=Se||!gn?gn:dt(),e){let e=qe[t].filter((t=>!(ve.includes(t)||0===gn&&t===b)));e.length||(e=qe[t]),ve[t]=e[n(e.length)]}else{let e=We[t].filter((t=>!(ke.includes(t)||0===gn&&t===b)));e.length||(e=We[t]),ke[t]=e[n(e.length)]}}swapAutos(t){const e=n(2);t?[We[e],We[e+2]]=[We[e+2],We[e]]:[qe[e],qe[e+2]]=[qe[e+2],qe[e]]}shiftAutomata(){if(ze)return;const t=Se||!gn?void 0:dt();this.timeToWait.forEach(((e,i)=>{const s=i?Ae:xe;e.forEach(((e,n)=>{(Se||!gn?void 0===s[n]&&gn%(10*e)==0||gn-s[n]>e*(zi?2:10):void 0===s[n]&&t%e==0||t-s[n]>(zi?.2*e:e))&&(a(.2)&&this.swapAutos(!i),this.updateAutoModes(n,!!i))}))})),this.genEnsureAutoRands(),this.ensureAutomataBalance()}resetAutomata(t=\"chosen\",e=!1){const i=gn-Pe;if(!(void 0!==Pe&&i<$e))switch(i>$e*Xe&&(Ye=0),Pe=gn,ns=0,Ye++,t){case\"death\":const t=n(Be.length),i=n(Be.length);ke[t]=Be[t],ve[i]=Be[i],xe[t]=Ae[i]=Se||!gn?gn:dt()-12;break;case\"growth\":if(Ye>Xe){let t=n(Fe.length);const e=a();(e?ke:ve)[t]=y,(e?xe:Ae)[t]=Se||!gn?gn-50:dt()-12,Ye=0}else if(e){let t=n(Fe.length);ke[t]=Fe[t],ve[t]=Fe[t],xe[t]=Ae[t]=Se||!gn?gn-50:dt()-12}else Fe.forEach(((t,e)=>{ke[e]=t,ve[e]=t,xe[e]=Ae[e]=Se||!gn?gn-50:dt()-12}));break;default:this.updateAutoModes(n(ke.length),a())}}checkAnimationSetStateAt(t,e){let i=0;return this.animations.forEach((s=>{i+=s.checkAnimationStateAt(t,e)})),[!1,~~(i%4)]}}class Gt extends qt{constructor(){const t=1+Ge[7]%2;super([Wt.indexOf(Dt),Wt.indexOf(Dt),Wt.indexOf(Dt),...t?[Wt.indexOf(Dt)]:[]]),this.branchyRendering=t,this.presetIndexes=et(t?3:2,[0,1,2,3]),this.presets=[];for(let t=0;t<this.animationClasses.length;t++){let i,o;if(this.presetIndexes.includes(t))[i,o]=u[n(u.length)];else{const t=a(),n=s(3.5,5);if(t){const t=s(.5,.92);o=t*e.sin(n)-.25*e.cos(2*n),i=t*e.cos(n)+.25*e.sin(2*n)}else{const t=s(.25,.35);o=1+t*e.sin(n),i=t*e.cos(n)}}this.presets.push({cx:i,cy:o,showIterations:a(.75),branchyBailoutType:a(.7)?0:n(1,5)})}}initAutomata(){const t=[...Ti,...Ri],e=et(3,t.filter((t=>![y,b].includes(t)))),i=et(3,t.filter((t=>!e.includes(t)))),s=et(3,t),a=et(3,t.filter((t=>![...e,...s].includes(t)))),o=n(4);We=[[...o%2?e:[],14,15],[...i,14,15],[...s,14,15],[...o>1?a:[],15]];const h=[...Ti,...Ri],r=et(3,h),l=et(3,[...h.filter((t=>m.includes(t)&&!r.includes(t)))]),c=et(3,[...h]),d=et(3,[...h.filter((t=>![...r,...l,...c].includes(t)))]),u=n(4);qe=[[...u%2?r:[],14,15],[...u<2?l:[],14,15],[...c,15],[...u>1?d:[],14,15]]}checkAnimationSetStateAt(t,e){const i=[],s=[];this.animations.forEach(((n,a)=>{const o=a;i[o]||(i[o]=0),s[o]||(s[o]=0);const h=+n.checkAnimationStateAt(t,e);h<0?s[o]+=-h:i[o]+=h}));const n=i.reduce(((t,e,i)=>t+e),0),a=s.reduce(((t,e,i)=>t+e),0),o=!n;return[o,o?a:n]}initAnimations(t,e){this.animations=this.animationClasses.map(((i,s)=>{const n=i===Dt?[0!==s&&(s<2||a()),0!==this.branchyRendering&&(1===this.branchyRendering||a()),this.presets[s],this.presetIndexes.includes(s)]:[];return new i(t,e,...n)}))}}class Nt extends qt{constructor(){super([...0===K?[Wt.indexOf(Et),Wt.indexOf(Et),Wt.indexOf(Dt),Wt.indexOf(Dt)]:1===K?[Wt.indexOf(Xt)]:[Wt.indexOf(Tt),Wt.indexOf(Tt)],...a(.83)?[]:[Wt.indexOf(Ft)],...a(.83)?[]:[Wt.indexOf(Ft)],Wt.indexOf(Ft)]),this.smoothTransitions=a(),this.classicTextures=a(.2),this.classicBgTextures=a(.2)}initAutomata(){const t=this.classicTextures?[0,3,9,11,13,16,21,22,23,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48]:[...Ti,...Ri],e=this.classicBgTextures?[0,3,9,11,13,16,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48]:[...Ti,...Ri],i=[...et(3,t),14,15],s=[...et(3,[...t.filter((t=>!i.includes(t))),a()?9:6]),14,15],n=[...et(3,t.filter((t=>![...i,...s].includes(t)))),14,15],o=[...et(3,t.filter((t=>![...i,...s,...n].includes(t)))),14,15,a()?9:6];We=[i,s,n,o];const h=[...et(3,e),14,15],r=[...et(3,[...e.filter((t=>!h.includes(t)))]),14,15],l=[...et(3,[...e.filter((t=>![...h,...r].includes(t))),a()?9:6]),14,15],c=[...et(3,[...e.filter((t=>![...h,...r,...l].includes(t)))]),14,15];qe=[h,r,l,c]}checkAnimationSetStateAt(t,i){let s=0,n=0;this.animations.forEach(((a,o)=>{let h=a.checkAnimationStateAt(t,i);a instanceof Ft?(this.smoothTransitions||(h=~~h),n+=h):s+=e.abs(+h)}));let a=0===s;return Ge[4]%2==0&&(a=!a),[a,~~(s+n)]}}class Ht extends qt{constructor(){super([Wt.indexOf(_t),Wt.indexOf(_t)]),this.smoothTransitions=a(),this.blendMode=n(2)}initAutomata(){const t=[...Ti,...Ri],e=[...et(3,t),15],i=[...et(3,t.filter((t=>m.includes(t)&&!e.includes(t)))),14,15],s=[...et(3,t.filter((t=>!m.includes(t)&&!e.includes(t)))),14,15],n=[...et(3,t.filter((t=>![...e,...i,...s].includes(t)))),14,15];We=[e,i,s,n];const a=[...Ti,...Ri],o=[...et(3,a),15],h=[...et(3,[...a.filter((t=>m.includes(t)&&!o.includes(t)))]),14,15],r=[...et(3,[...a.filter((t=>m.includes(t)&&!o.includes(t)))]),14,15],l=[...et(3,[...a.filter((t=>![...o,...h,...r].includes(t)))]),14,15];qe=[o,h,r,l]}initAnimations(t,e){if(a(.5))return void super.initAnimations(t,e);let i=new Array(6).fill(!1);if(a(.3)||(i=[a(),a(),a(),a(),a(),a()]),!i.some((t=>t))){i[n(6)]=!0}const o=s(.25),h=i[1]?[0,0]:[o,o],r=s(d),l=[r,r+(i[0]?Math.PI:0)];this.animations=this.animationClasses.map(((i,s)=>new i(t,e,...[h[s],l[s]]))),i[5]&&(this.animations[0].rotationSpeed=s(0,.025)-.0125),this.animations[1].spiralPower=this.animations[0].spiralPower,this.animations[1].spiralMultiplier=this.animations[0].spiralMultiplier*(i[4]?s(.5,2):1),this.animations[1].flip2=this.animations[0].flip2,this.animations[1].flip3=this.animations[0].flip3^i[1],this.animations[1].zoom=this.animations[0].zoom,this.animations[1].rotationSpeed=this.animations[0].rotationSpeed*(i[5]?s(.2,3):1),this.animations[1].rOffset=this.animations[0].rOffset+(i[2]?Math.PI\/2:0),this.animations[1].speed=this.animations[0].speed*(i[3]?s(0,2):1),this.animations[1].inversionRadius=this.animations[0].inversionRadius,this.animations[1].cAdd=this.animations[1].zoom*h[1]*Math.cos(l[1]),this.animations[1].dAdd=this.animations[1].zoom*h[1]*Math.sin(l[1]),this.animations[1].warpThetaMult=this.animations[0].warpThetaMult,this.animations[1].warpRMult=this.animations[0].warpRMult}checkAnimationSetStateAt(t,e){let i=0,s=0,n=!1;this.animations.forEach(((a,o)=>{let h=a.checkAnimationStateAt(t,e);this.smoothTransitions||(h=~~h),0===this.blendMode&&(n=h%2<1),(0===this.blendMode?n:h%4<2)?s+=h:i+=h})),1===this.blendMode&&(n=(s+i)%4<2);const a=0===this.blendMode?~~(s+i):n?~~s:~~i;return[n,a]}}class jt extends qt{constructor(){super([Wt.indexOf(Pt),...$?[Wt.indexOf(Tt),Wt.indexOf(Tt)]:W?[Wt.indexOf(Xt)]:[Wt.indexOf(_t)],...q?[Wt.indexOf(Dt),Wt.indexOf(Dt)]:[],...G?[Wt.indexOf(Ct),Wt.indexOf(Ct),Wt.indexOf(zt),Wt.indexOf(zt)]:[]]),this.blendMode=a()}initAutomata(){const t=[...Ti,...Ri],e=[...et(3,t),14],i=[...et(1,t.filter((t=>!e.includes(t)&&m.includes(t)))),14,15],s=[...et(1,t.filter((t=>![...e,...i].includes(t)))),14,15],o=[...et(3,t.filter((t=>![...e,...i,...s].includes(t)))),14,15];We=[e,i,s,o];const h=[...Ti,...Ri],r=[!1,!1,!1],l=n(3);a()&&(r[l]=!0);const c=et(3,h),d=r[0]?[14,15]:[...et(1,[...h.filter((t=>!c.includes(t)))]),14,15],u=r[1]?[14,15]:[...et(2,[...h.filter((t=>![...c,...d].includes(t)))]),14,15],f=r[2]?[14,15]:[...et(2,[...h.filter((t=>![...c,...d,...u].includes(t)))]),14,15];qe=[c,d,u,f]}checkAnimationSetStateAt(t,i){let s=0,n=0,a=!1;this.animations.forEach(((e,o)=>{let h=+e.checkAnimationStateAt(t,i);this.blendMode?o||(a=h%2<1):0===o&&(a=h%8<4),a?n+=h:s+=h}));const o=e.abs(~~(n+s+.5));return[a,o]}}class Ut extends qt{constructor(){super([Wt.indexOf(Xt),Wt.indexOf(Xt),...H?[[Wt.indexOf(Tt),Wt.indexOf($t),Wt.indexOf(Pt)][J]]:[],...j?[[Wt.indexOf(Tt),Wt.indexOf($t),Wt.indexOf(Pt)][V]]:[],...U?[[Wt.indexOf(Tt),Wt.indexOf($t),Wt.indexOf(Pt)][Q]]:[]]),this.withMoire=a(.2),this.pureInvert=N,this.smoothTransitions=this.withMoire||a(.75),this.bgType=n(N?2:0,5),this.resultType=n(3)}initAutomata(){const t=[...Ti,...Ri],e=et(3,t),i=(this.withMoire,[14,15]),s=this.withMoire?[14,15]:[...et(2,t.filter((t=>m.includes(t)&&!e.includes(t)))),14,9,15],n=[...et(3,t.filter((t=>![...e,...i,...s].includes(t)))),14,15];We=[e,i,s,n];const a=[...Ti,...Ri],o=et(3,a),h=this.pureInvert?[14,15]:[...et(2,[...a.filter((t=>m.includes(t)&&!o.includes(t)))]),14,15],r=[14,15],l=[...et(3,[...a.filter((t=>![...o,...h,...r].includes(t)))]),14,15];qe=[o,h,r,l]}initAnimations(t,e){if(a(.15))return void super.initAnimations(t,e);const i=[a(),a(),a(.1),a(.1),a(.25)];let n=a();const o=s(.2,.4),h=[o,o],r=a(.25)?a()?c:0:s(d),l=[r,r+Math.PI];this.animations=this.animationClasses.map(((i,s)=>new i(t,e,...[h[s],l[s]]))),!r&&a()&&(a(.25)&&(this.animations[0].rOffset=0),n=!0),this.withMoire&&(this.animations[0].inversionRadius=1\/s(2.5,4),this.animations[0].zoom=1\/s(.6,2)),this.animations[0].cAdd=this.animations[0].zoom*h[0]*Math.cos(l[0]),this.animations[0].dAdd=this.animations[0].zoom*h[0]*Math.sin(l[0]),this.animations[1].withSpiral=this.animations[0].withSpiral,this.animations[1].spiralPower=this.animations[0].spiralPower,this.animations[1].radiusWarpSpeed=this.animations[0].radiusWarpSpeed,this.animations[1].spiralMultiplier=this.animations[0].spiralMultiplier,this.animations[1].flip2=this.animations[0].flip2^i[3],this.animations[1].flip3=this.animations[0].flip3^i[2],this.animations[1].zoom=this.animations[0].zoom,this.animations[1].rotationSpeed=this.animations[0].rotationSpeed*(n?-1:1),this.animations[1].rOffset=i[1]?this.animations[0].rOffset+Math.PI:this.animations[0].rOffset*(i[0]?-1:1),i[4]||(this.animations[1].absC=this.animations[0].absC,this.animations[1].absD=this.animations[0].absD),this.animations[1].speed=this.animations[0].speed,this.animations[1].inversionRadius=this.animations[0].inversionRadius,this.animations[1].cAdd=this.animations[1].zoom*h[1]*Math.cos(l[1]),this.animations[1].dAdd=this.animations[1].zoom*h[1]*Math.sin(l[1])}checkAnimationSetStateAt(t,i){let s,n,a=0,o=0;switch(this.animations.forEach(((e,s)=>{let n=e.checkAnimationStateAt(t,i);e instanceof Xt?(this.smoothTransitions||(n=~~n),a+=n):o+=-1===n?0:n})),this.resultType){case 0:s=e.abs(~~((o+a)\/2));break;case 1:s=o%4>2?~~((e.abs(o)+e.abs(a))\/2):~~(e.abs(o)+e.abs(a)+2);break;case 2:s=o>1?e.abs(~~(o+a+3)):e.abs(~~(o||a))}switch(this.bgType){case 0:n=!!o;break;case 1:n=~~(a%3)>6;break;case 2:n=~~(a%4)>8;break;case 3:n=0==~~(a%(o+1));break;case 4:n=~~(a%(o+1))<3}return[n,s]}}class Jt extends qt{constructor(){super([Wt.indexOf(Tt),Wt.indexOf(Tt),Wt.indexOf(Tt),Wt.indexOf(Tt),...[[Wt.indexOf(_t),Wt.indexOf(_t)],[Wt.indexOf(Dt),Wt.indexOf(Dt)],[Wt.indexOf($t),Wt.indexOf($t)],[Wt.indexOf(Yt),...a()?[]:[Wt.indexOf(Yt)]],[Wt.indexOf(Et),Wt.indexOf(Et),Wt.indexOf(Et)]][tt]]),this.mixType=a(.2)?3:n(3)}initAutomata(){const t=[...et(6,[...Ti,...Ri,6])],e=[...et(6,[...Ti,...Ri,9].filter((e=>!t.includes(e))))];for(;e.length<6;)e.push(et(1,[...Ti,...Ri])[0]);We=[[...et(3,t),14],[...et(3,t),14,15],[...et(3,t),14,15],[...et(3,t),14,15]],qe=[[...et(3,e),14],[...et(3,e),14,15],[...et(3,e),14,15],[...et(3,e),14,15]]}checkAnimationSetStateAt(t,e){let i=0,s=0,n=!1;return this.animations.forEach(((a,o)=>{const h=+a.checkAnimationStateAt(t,e);-1===h&&(n=!0),a instanceof Tt?i+=-1===h?1:h:s+=h<0?0:h})),[!i,~~(i?i%3!==this.mixType?s+i:i:s)]}initAnimations(t,e){const i=n(8,15);this.animations=this.animationClasses.map(((s,a)=>{let o=[];return s===Tt&&(o=[2*a,n(4,i)]),new s(t,e,...o)}))}}class Vt extends qt{constructor(){super([Wt.indexOf($t),Wt.indexOf($t),Wt.indexOf($t),...a()?[]:[Wt.indexOf($t)],...a()?[]:[Wt.indexOf($t)],...a()?[]:[Wt.indexOf($t)]])}initAutomata(){const t=[...Ti,...Ri,9],e=et(3,t),i=et(3,t.filter((t=>m.includes(t)&&!e.includes(t)))),s=et(3,t.filter((t=>!m.includes(t)&&!e.includes(t)))),n=et(3,t.filter((t=>![...e,...i,...s].includes(t))));We=[[...e],[...i,9,y,b],[...s,y,b],[...n,y,b]];const a=[...Ti,...Ri,9],o=[...et(3,a),y,9],h=[...et(3,[...a.filter((t=>m.includes(t)&&!o.includes(t)))]),y,b],r=[...et(3,[...a.filter((t=>m.includes(t)&&![...o,...h].includes(t)))]),y,b,9],l=[y,b,...et(3,a)];qe=[o,h,r,l]}checkAnimationSetStateAt(t,e){let i=0,s=0;return this.animations.forEach(((n,a)=>{const o=+n.checkAnimationStateAt(t,e);a<1?i+=o:s+=o})),[!i,i+s]}}class Qt extends qt{constructor(){let t;switch(Z){case 0:t=[Wt.indexOf(Ft),Wt.indexOf(Ft),Wt.indexOf(Ft)];break;case 1:t=[Wt.indexOf(Et),Wt.indexOf(Et)];break;case 2:t=[Wt.indexOf(_t),...a()?[]:[Wt.indexOf(_t)]];break;case 3:t=[Wt.indexOf(zt),Wt.indexOf(Ct),...a()?[]:[Wt.indexOf(zt)],...a()?[]:[Wt.indexOf(Ct)]];break;case 4:t=[Wt.indexOf(Dt),Wt.indexOf(Dt),...a()?[]:[Wt.indexOf(Dt)]]}super([Wt.indexOf($t),...t]),this.bgType=n(5),this.smoothTransitions=a()}initAutomata(){const t=[...Ti,...Ri,9],e=et(3,t),i=et(3,t.filter((t=>m.includes(t)&&!e.includes(t)))),s=et(3,t.filter((t=>![...e,...i].includes(t)))),n=et(3,t.filter((t=>![...e,...i,...s].includes(t))));We=[[...e,14,15],[...i,9,14,15],[...s,14,15],[...n,14,15,6]];const a=[...Ti,...Ri,9],o=[...et(3,a),14,15,9],h=[...et(3,[...a.filter((t=>m.includes(t)&&!o.includes(t)))]),14,15],r=[...et(3,[...a.filter((t=>m.includes(t)&&!o.includes(t)))]),14,15,9],l=et(3,[...a.filter((t=>![...o,...h,...r].includes(t))),14,15]);qe=[o,h,r,l]}checkAnimationSetStateAt(t,i){let s=0,n=0,a=!1;switch(this.animations.forEach((a=>{let o=+a.checkAnimationStateAt(t,i);this.smoothTransitions||(o=~~o),a instanceof $t?s+=o:n+=e.abs(o)})),this.bgType){case 0:a=!s;break;case 1:a=!((n+s)%2);break;case 2:a=n&&!s;break;case 3:a=!((n+s)%3);break;case 4:a=!((n+s)%4)}return[a,~~(s+n)]}initAnimations(t,e){this.animations=this.animationClasses.map((i=>new i(t,e,...i===$t?[!0]:[])))}}const Zt=(t,i,n,a,o,h,r,l)=>{let c=t;switch(i){case 0:t?(h>.6||r>.25)&&(c=!1):h>.35&&h<.4&&(c=!0);break;case 1:t?(h>.7||r>.35&&r>.45)&&(c=!1):l>.3&&l<.7&&(c=!0);break;case 2:t?(l>.7||r>.5&&r>.55)&&(c=!1):l>.4&&l<.8&&(c=!0);break;case 3:t?(h>.7||r>.45&&r>.55)&&(c=!1):l>.4&&l<.7&&(c=!0);break;case 4:t?(h>.8||r>.5&&r>.55)&&(c=!1):l>.4&&l<.8&&(c=!0);break;case 5:t?((n<3||4===n)&&a<8||a<16&&a>13)&&(c=!1):((4===n||n>5)&&a>9||a>1&&a<4)&&(c=!0);break;case 6:t?(n<3||5===n)&&(c=!1):(3===n||n>5)&&(c=!0);break;case 7:t?l>1.1*r&&(c=!1):l<.9*h&&(c=!0);break;case 8:t?(r>=0&&r<.25||r>=.5&&r<=1)&&(c=!1):r>.25&&r<.5&&(c=!0);break;case 9:t?(l<=3\/8||l>=.625&&l<=11\/16)&&(c=!1):(l>=5\/16&&l<=6\/16||l>=5\/8)&&(c=!0);break;case 10:t?(3===n&&(a>5||a<3)||99===a)&&(c=!1):(2===n&&a<8||99===a)&&(c=!0);break;case 11:c=t?3===n||n>1&&a<9:3===a;break;case 12:c=t?o>1&&o<10:4===a;break;case 13:c=t?![3,4,5,7].includes(a)&&![2].includes(n):[4].includes(a)||[3].includes(n);break;case 14:c=1;break;case 15:c=0;break;case 16:switch(t){case 0:c=3===n?1:0;break;case 1:c=2===n?1:3===n?2:0;break;case 2:c=2===n?2:3===n?3:4===n?1:0;break;case 3:c=2===n?3:3===n?1:1===n?2:0}break;case 17:switch(t){case 0:c=3===n?1:2===n?2:0;break;case 1:c=2===n?1:3===n?2:0;break;case 2:c=2===n?2:3===n?3:0;break;case 3:c=2===n?3:3===n?1:5===n?2:0}break;case 18:1===t?c=n<2?0:n<4?1:n<6?2:0:0===t?c=n<3?0:n<4?1:0:2===t&&(c=1);break;case 19:c=1===t?n<2?0:n<4?1:n<6?2:0:0===t?n<3?0:n<4?1:n>6&&n<8?3:0:2===t?1:0;break;case 20:c=(!t||!(n<2||n>5||a>6))&&(!(t||3!==n||1!==a&&2!==a&&3!==a&&4!==a)||t);break;case 21:c=(!t||!(n<2||n>5))&&(!t&&(4===n||5===n)&&l>=.4&&l<=1||(!!(t&&3===n&&l>=.6&&l<=.9)||!(t&&n>=2&&n<=4&&l<.2)&&(!(t&&n>=2&&n<=4&&l>=.9)&&t)));break;case 22:c=(!t||!(n<2||n>5))&&(!t&&(3===n||5===n)&&l>=.5&&l<=1||!(t&&n>=3&&n<=5&&l<.3)&&(!(t&&n>=3&&n<=5&&l>=.8)&&(!!(t&&2===n&&l>=.7)||t)));break;case 23:c=(!t||!(n<3||n>6))&&(!t&&(3===n||6===n)&&l>=.4&&l<=1||(!!(t&&4===n&&l>=.5&&l<=.8)||!(t&&n>=3&&n<=5&&l<.3)&&(!(t&&n>=3&&n<=5&&l>=.9)&&t)));break;case 24:c=s(1)<.5?(!t||!(n<3||n>6))&&(!t&&(3===n||6===n)&&l>=.4&&l<=1||(!!(t&&4===n&&l>=.5&&l<=.8)||!(t&&n>=3&&n<=5&&l<.3)&&(!(t&&n>=3&&n<=5&&l>=.9)&&t))):(!t||!(n<2||n>5))&&(!t&&(4===n||5===n)&&l>=.4&&l<=1||(!!(t&&3===n&&l>=.6&&l<=.9)||!(t&&n>=2&&n<=4&&l<.2)&&(!(t&&n>=2&&n<=4&&l>=.9)&&t)));break;case 25:c=2===n?t:(!t||!(n<3||n>6))&&(!t&&6===n&&l>=.4&&l<=1||(!!(t&&4===n&&l>=.5&&l<=.8)||!(t&&n>=3&&n<=5&&l<.3)&&(!(t&&n>=3&&n<=5&&l>=.9)&&(!t&&5===n&&l>=.6&&l<=1||(!!(t&&3===n&&l>=.6&&l<=.9)||!(t&&n>=2&&n<=4&&l<.2)&&(!(t&&n>=2&&n<=4&&l>=.9)&&t))))));break;case 26:c=2===n?t:(!t||!(n<2||n>5))&&(!t&&n>=3&&n<=6&&l>=.4&&l<=1||(!!(t&&n>=2&&n<=6&&a>=3&&a<=5&&l>=.5&&l<=.8)||!(t&&n>=2&&n<=5&&l<.3)&&(!(t&&n>=2&&n<=5&&l>=.9)&&t)));break;case 27:c=(!t||!(n<2||n>5))&&(!t&&(3===n||5===n)&&l>=.5&&l<=1||t);break;case 28:t?c=(n<2||n>4)&&a<8?0:1===t&&4===n&&l>=.6&&l<=.9?2:2===t&&n>=2&&n<=4&&l<.3?3:3===t&&n>=2&&n<=4&&l>=.8?1:t:(4===n||n>5)&&a>9&&(c=1);break;case 29:t?c=!((n<3||n>6)&&a<8)&&(4===n&&l>=.6&&l<=.9||!(n>=3&&n<=6&&l<.3)&&(!(n>=3&&n<=6&&l>=.85)&&t)):(4===n||n>5)&&a>9&&(c=!0);break;case 30:t?c=!((n<2||n>5)&&a<6)&&(4===n&&l>=.6&&l<=.9||!(n>=3&&n<=6&&l<.3)&&(!(n>=3&&n<=6&&l>=.85)&&t)):(3===n||n>4)&&a>7&&(c=!0);break;case 31:t?c=!(n<2||n>5)&&(3===n&&a>5&&l>=.4&&l<=.8||!(4===n&&l<.2)&&t):(3===n||5===n&&a>6&&l>.3&&l<.9)&&(c=!0);break;case 32:t?c=!(n<2||n>6)&&(4===n&&a<10&&l>=.4&&l<=.8||!(n>=2&&n<=5&&l<.3)&&t):(3===n||6===n&&a>5&&l>.3&&l<.9)&&(c=!0);break;case 33:t?c=n<2||n>6?0:1===t&&4===n&&l>=.6&&l<=.9?2:2===t&&n>=3&&n<=5&&l<.3?3:3===t&&n>=3&&n<=6&&l>=.85?1:t:(3===n||5===n)&&a>5&&l>.2&&l<.8&&(c=1);break;case 34:t?c=n<2||n>6?0:1===t&&4===n&&l>=.55&&l<=.95?2:2===t&&n>=2&&n<=4&&l<.35?3:3===t&&n>=3&&n<=7&&l>=.75?1:t:(3===n||5===n)&&a>3&&l>.1&&l<.9&&(c=1);break;case 35:t?c=n<3||n>7?0:1===t&&5===n&&l>=.5&&l<=.9?2:2===t&&n>=2&&n<=5&&l<.3?3:3===t&&n>=3&&n<=6&&l>=.8?1:t:(4===n||6===n)&&a>4&&l>.2&&l<.8&&(c=1);break;case 36:c=t?!(n<2||4===n&&a<8||a>12&&a<16):3===n||n>5&&a>8||a>1&&a<5;break;case 37:c=t?!(n<2||n>4||a>=11&&a<=14&&l<=.4):2===n||3===n&&a>=5&&l>=.4;break;case 38:c=t?!(n<2||n>5||a>=7&&a<=11&&l<=.6):3===n||4===n&&a>=3&&l>=.2&&l<=.8;break;case 39:c=t?!(n<2||n>4||h<=.3&&r>=.6):2===n||3===n&&h>=.4&&r<=.8;break;case 40:c=t?!(n>1&&n<5&&(a<8||a>12||l>.5)):!(2!==n&&(3!==n||a<4||l<.3||l>.7));break;case 41:c=t?!(n<2||n>5||h<=.3&&r>=.6||a%5==0&&l<=.5):3===n||4===n&&a>=3&&l>=.2&&l<=.8;break;case 42:c=t?!(n<2||n>5||a>=7&&a<=11&&l<=.6||4===n&&h<=.3&&r>=.6):3===n||4===n&&a>=3&&l>=.2&&l<=.8;break;case 43:let i=(n+a)\/2;c=t?!(n<2||n>4||i>=8&&i<=10&&l<=.4):2===n||3===n&&i>=6&&l>=.4;break;case 44:let d=(n+a)\/2;c=t?!(n<2||n>4||d>=7&&d<=10&&l<=.4):n>=1&&n<=3||4===n&&d>=6&&l>=.4;break;case 45:let u=e.sin(n\/(a+1));c=t?!(n<2||n>5||a>=11&&a<=14&&l<=.4||u<=-.5):3===n||2===n&&a>=5&&l>=.4&&u>=.5;break;case 46:let m=e.sin(n\/(a+1));c=t?!(n<2||n>5||a>=11&&a<=14&&l<=.4||m<=-.5):3===n||2===n&&a>=5&&l>=.4&&m>=.5||1===n&&a<2;break;case 47:let f=e.sin(n\/(a+1));c=t?!(n<2||n>5||a>=11&&a<=14&&l<=.4||f<=-.5||f>=.2&&o>15):(3===n||2===n&&a>=5&&l>=.4&&f>=.5||1===n&&a<2)&&a<5;break;case 48:let p=e.sin(n\/(a+1));c=t?!(n<2||n>5||a>=11&&a<=14&&l<=.4||p<=-.5||p>=.5&&o>15||o===4*n-3||o===2*n+3||o>n*e.E+3):(3===n||2===n&&a>=5&&l>=.4&&p>=.3||1===n&&a<2)&&a<5;break;case 49:c=(!t||!(n<4||n>8||l<.3))&&(!t&&5===n&&l>.55||!!t);break;case 50:c=(!t||!(n<3||n>7))&&(!t&&(3===n||4===n||5===n)&&l>=.6&&l<=1||(!!(t&&2===n&&l>=.6)||!(t&&(n<3||n>5)&&l<.3)&&(!(t&&(n<3||n>5)&&l>=.8)&&t)));break;case 51:t?n<3||n>6?c=!1:4===n&&l>=.4&&l<=.8&&(c=!0):(3===n||6===n)&&l>=.2&&l<=1?c=!0:n>=2&&n<=5&&l<.3&&(c=!1);break;case 52:c=(!t||!(n<1||n>7||l<.3||l>.8))&&(!t&&(1===n&&l>.7||2===n&&l>.6||3===n&&l>.5||4===n&&l>.4||n>4&&l>.3)||t);break;default:c=t}return+c},Kt=a()?n(50,300):n(300,3e3),te=()=>{const t=ye([2,94,0,69],[2,94,0,69],[4,92,0,67],[8,90,0,65],[10,60,0,50],[10,55,0,55],[10,50,0,60],[95,0,10,10],[95,0,40,10],[95,0,0,10],[85,0,60,10],[75,0,0,0],[10,45,0,65],[0,85,90,10],[0,80,100,0],[2,78,98,0],[0,100,0,50],[80,68,92,12],[80,68,92,12],[0,68,92,12],[0,100,0,50],[95,0,10,10],[55,0,0,10],[70,0,10,10]);return t.c=t.c.map((t=>kt(t,220))),t},ee=()=>{let t=ye([0,10,0,90],[0,7,37,0],[58,42,0,25],[58,22,14,22],[39,0,n(18,34),32]);return t.c=t.c.map((t=>kt(t,0))),t},ie=()=>ye([0,0,0,100],[0,28,100,0],[0,80,100,0],[0,28,100,0],[10,0,5,0],[0,28,100,0],[80,70,30,0],[0,28,100,0],[0,n(35,40),100,n(20,30)]),se=()=>{let t=ye([0,0,0,100],[10,0,5,0],[0,38,90,0],[0,28,100,0],[10,0,5,0],[0,0,0,95],[10,0,0,95],[0,28,100,0],[0,23,100,0]);return t.c=t.c.map((t=>kt(t,336))),t},ne=()=>ye([0,10,15,2],[0,20,50,5],[0,30,60,15],[0,35,55,40],[0,15,45,7],[0,70,60,5],[0,80,70,10],[0,85,75,8],[0,20,50,5],[85,28,0,90],[0,30,60,15],[0,35,55,40],[0,15,45,7],[0,88,78,40],[0,90,80,60],[0,85,75,5],[87,30,0,100],[n(75,86),n(28,39),0,90]),ae=()=>({c:[...At([0,0,20,0],[0,0,0,100],50),...At([0,0,0,100],[0,0,20,0],50),...At([0,0,20,0],[0,0,0,100],50)]}),oe=()=>{const t=ye([0,0,0,100],[3,0,3,100],[0,0,0,55],[0,8,8,60],[0,0,0,30],[0,0,0,80],[20,10,0,70],[0,0,0,90],[0,10,0,30],[0,0,7,100],[0,0,0,70],[0,10,0,60],[0,10,0,30]);let e=[n(360)];const i=e[n(e.length)];return t.c=t.c.map((t=>kt(t,i))),t},he=()=>{const t=ye([0,0,10,20],[0,0,10,10],[10,0,0,20],[0,0,0,20],[3,10,8,60],[0,0,0,50],[0,0,0,80],[9,0,3,20],[4,6,9,30],[0,10,10,10],[0,0,0,0]);let e=[n(360)];const i=e[n(e.length)];return t.c=t.c.map((t=>kt(t,i))),t},re=()=>ye([100,66,0,0],[48,0,61,20],[0,58,86,0],[70,80,50,20],[48,0,61,20],[80,70,40,10]),le=()=>ye([0,85,75,8],[38,73,0,50],[0,20,14,15],[33,49,0,20],[0,85,75,8],[0,20,14,5],[33,49,0,20],[0,85,75,100],[33,49,0,20],[38,73,0,50],[33,49,0,20],[38,73,0,50]),ce=()=>{const t=ye([63,28,0,53],[55,25,0,25],[50,20,0,30],[45,18,0,32],[72,38,0,46],[75,35,0,44],[78,40,0,42],[70,0,0,0],[2,94,0,49],[4,92,0,47],[8,90,0,45],[10,60,0,30],[10,55,0,35],[10,50,0,40],[10,45,0,45],[0,85,90,10],[0,80,100,0],[2,78,98,0],[0,70,80,20],[10,15,75,5],[40,30,70,30],[0,70,90,10],[0,68,92,32],[20,88,92,87]);return t.c=t.c.map((t=>kt(t,220))),t},de=()=>ye([63,28,0,53],[65,30,0,52],[68,32,0,50],[72,35,0,48],[2,94,0,69],[4,92,0,67],[10,60,0,50],[12,63,0,48],[0,80,90,0],[0,78,92,2],[0,50,100,0],[2,52,98,2]),ue=t=>{let i=[];for(let t=1;t<7;t+=1){const s=121*t**5\/120-141*t**4\/8+2657*t**3\/24-2319*t**2\/8+16247*t\/60-7,n=641*t**5\/120-775*t**4\/8+15821*t**3\/24-16585*t**2\/8+58989*t\/20-1405,a=22*t**5\/5-305*t**4\/4+2971*t**3\/6-5983*t**2\/4+62443*t\/30-975;i.push([h(0,100,e.round(s)),h(0,100,e.round(n)),h(0,100,e.round(a)),h(0,100,e.round(0))])}const s=ye(...i,[18,9,75,0],[23,53,59,0],[76,52,78,n(5,15)]);return s.c=s.c.map((t=>kt(t,20))),s},me=()=>ye([80,80,20,30],[80,80,20,30],[0,60,40,0],[0,0,80,0],[40,40,80,0],[0,0,0,100],[0,0,0,100],[100,30,0,0],[100,0,0,50],[70,80,20,30]),fe=()=>{const t=ye([68,39,34,0],[3,35,70,0],[44,82,95,0],[44,82,95,0],[44,82,95,0],[44,82,95,0],[4,2,16,0],[18,9,75,0],[23,53,59,0],[0,0,0,100],[76,52,78,77]);return t.c=t.c.map((t=>kt(t,200))),t},pe=()=>ye([87,42,0,60],[0,4,19,2],[0,14,61,4],[0,37,68,7],[0,65,78,2],[0,82,76,13],[0,82,76,90]),ge=()=>ye([68,39,34,0],[11,96,87,0],[3,35,70,0],[44,82,95,0],[74,61,28,0],[94,35,17,0],[18,9,75,0],[23,53,59,0],[96,52,78,99]),ye=(...t)=>{let e=[];1===t.length&&t.push(t[0]);for(let i=0;i<t.length-1;i++)e=[...e,...At(t[i],t[i+1],~~(Kt\/(t.length-1)))];return{c:e}};let be={unused:[],Spectrum:ye([68,39,34,0],[11,96,87,0],[3,35,70,0],[44,82,95,0],[74,61,28,0],[94,35,17,0],[18,9,75,0],[23,53,59,0],[96,52,78,99]),Graphite:{c:[...At([0,0,20,0],[0,0,0,100],50),...At([0,0,0,100],[0,0,20,0],50),...At([0,0,20,0],[0,0,0,100],50)]},Sunbeam:te(),Seafoam:ee(),Ember:ye([0,10,15,2],[0,20,50,5],[0,30,60,15],[0,35,55,40],[0,15,45,7],[0,70,60,5],[0,80,70,10],[0,85,75,8],[0,20,50,5],[85,28,0,90],[0,30,60,15],[0,35,55,40],[0,15,45,7],[0,88,78,40],[0,90,80,60],[0,85,75,5],[87,30,0,100],[n(75,86),n(28,39),0,90]),Scorch:ye([87,42,0,60],[0,4,19,2],[0,14,61,4],[0,37,68,7],[0,65,78,2],[0,82,76,13],[0,82,76,90]),Energizer:ue(),\"Last Light\":ye([63,28,0,53],[65,30,0,52],[68,32,0,50],[72,35,0,48],[2,94,0,69],[4,92,0,67],[10,60,0,50],[12,63,0,48],[0,80,90,0],[0,78,92,2],[0,50,100,0],[2,52,98,2]),Riverine:ce(),Dusk:ye([0,85,75,8],[38,73,0,50],[0,20,14,15],[33,49,0,20],[0,85,75,8],[0,20,14,5],[33,49,0,20],[0,85,75,100],[33,49,0,20],[38,73,0,50],[33,49,0,20],[38,73,0,50]),\"Blue Skies\":ye([100,66,0,0],[48,0,61,20],[0,58,86,0],[70,80,50,20],[48,0,61,20],[80,70,40,10]),\"Black and White\":he(),Charcoal:oe(),\"Golden Hour\":ye([0,0,0,100],[0,28,100,0],[0,80,100,0],[0,28,100,0],[10,0,5,0],[0,28,100,0],[80,70,30,0],[0,28,100,0],[0,n(35,40),100,n(20,30)]),Asiimov:se(),Midnight:fe(),CMYK:ye([80,80,20,30],[80,80,20,30],[0,60,40,0],[0,0,80,0],[40,40,80,0],[0,0,0,100],[0,0,0,100],[100,30,0,0],[100,0,0,50],[70,80,20,30])};const we=()=>{let t=[[],[],[],[]],i=[];for(let s=0;s<4;s++){i[s]=[...be[Object.keys(be)[C[s]]].c].map((t=>yt(...t)));for(let n=0;n<Kt+1;n++)t[s][n]=e.max(0,~~(i[s].length*n\/Kt)-1)}i.forEach(((t,e)=>{let s=n(~~(.25*t.length),~~(.75*t.length));if(Ai)for(let e=0;e<s;e++)t=it(t);i.forEach(((i,s)=>{if(e!==s)for(let e=0;e<3e3;e++){const e=n(t.length);if(Ai)for(let s=0;s<10;s++){const n=(s+e)%t.length,a=~~(n\/t.length*i.length);[t[n],i[a]]=[i[a],t[n]]}}}))})),i.forEach((t=>{let e=n(~~(.25*t.length),~~(.75*t.length));if(wi)for(let i=0;i<e;i++)t=it(t)}));let s=i.map((t=>JSON.stringify(t)));return[i,s,t]};let xe,Ae,ke,ve,Me=w,Se=w,Oe=!0,ze=!1;const Ce=n(g.length),Te=n(g.length),Re=n(g.length),Ee=n(g.length),Be=[g[Ce],g[Te],g[Re],g[Ee]],De=n(p.length),Ie=n(p.length),Le=n(p.length),_e=n(p.length),Fe=[p[De],p[Ie],p[Le],p[_e]];let Pe,Ye=0;const Xe=15,$e=5;let We,qe=[],Ge=r(tokenData),Ne=parseInt(tokenData.tokenId)%1e6;const He=()=>{aa(),ha(),ia()},je=()=>{sa(),ha(),na()},Ue=()=>{sa(),aa(),oa()};let Je,Ve=`<div>\\n  <h2>because unless until<\/h2>\\n  <div>\\n    <a\\n            style=\"color: white; text-decoration: underline\"\\n            href=\"https:\/\/twitter.com\/ixnayokay\"\\n            target=\"_blank\"\\n    >@ixnayokay<\/a\\n    >, 2023\\n  <\/div>\\n  <br\/>\\n  <div>\\n    <button onclick=\"${Ue.name}()\">Today<\/button>\\n    <button onclick=\"${He.name}()\">Help<\/button>\\n    <button onclick=\"${je.name}()\">Controls<\/button>\\n  <\/div>\\n  <br\/>\\n  <hr\/>\\n<\/div>`,Qe='<div>\\n  <h2>Controls<\/h2>\\n  <h3>General<\/h3>\\n  <ul>\\n    <li>Esc\/H: Press to close menu<\/li>\\n    <li>\\n      C: Toggle Canonical mode (default: off)\\n      <ul>\\n        <li>\\n          When enabled, the animation renders as if the current date was the\\n          Unix epoch -- January 1, 1970\\n        <\/li>\\n        <li>While in this mode, all special day behaviors are disabled<\/li>\\n      <\/ul>\\n    <\/li>\\n    <li>\\n      D: Toggle \"Special Day\" (default: on)\\n      <ul>\\n        <li>If a special day is active, this disables it, giving the default animation appearance<\/li>\\n      <\/ul>\\n    <\/li>\\n    <li>\\n      X: Detail Level mode\\n      <ul>\\n        <li>\\n          In this mode, Left Arrow and Right Arrow change the number of cells in\\n          the animation. Higher levels require more performance!\\n        <\/li>\\n        <li>\\n          Only available while Canonical mode is enabled -- or in mint 0, for\\n          demo purposes\\n        <\/li>\\n        <li>Press Q to exit Detail Level mode<\/li>\\n      <\/ul>\\n    <\/li>\\n  <\/ul>\\n  <h3>Display<\/h3>\\n  <ul>\\n    <li>M: View Fullscreen<\/li>\\n    <li>S: Save an image of the current frame<\/li>\\n    <li>\\n      A: Aspect Ratio mode (default: 16:9)\\n      <ul>\\n        <li>\\n          Once enabled, press a number key to select from the preset aspect\\n          ratios\\n        <\/li>\\n        <li>\\n          Available ratios: 16:9, 9:16, 4:3, 3:4, 2:1, 1:2, 3:1, 1:3, 1:1,\\n          Responsive\\n        <\/li>\\n        <li>Press Q to exit Aspect Ratio mode<\/li>\\n      <\/ul>\\n    <\/li>\\n\\n    <li>\\n      T: Toggle Stretch\/\"Perfect Pixel\" mode (default: Stretch)\\n      <ul>\\n        <li>\\n          Stretch mode: stretches the animation to fill the window in its\\n          smallest dimension.\\n        <\/li>\\n        <li>\\n          Perfect Pixel mode: Image elements are sized to align with the pixels\\n          of the user\\'s screen, improving sharpness and performance. May be\\n          smaller than the screen.\\n        <\/li>\\n      <\/ul>\\n    <\/li>\\n  <\/ul>\\n  <h3>Timing<\/h3>\\n  <ul>\\n    <li>\\n      G: Pause\/unpause pattern changes\\n      <ul>\\n        <li>Great if you\\'re really enjoying things just the way they are<\/li>\\n      <\/ul>\\n    <\/li>\\n    <li>P: Pause\/Unpause animation<\/li>\\n    <li>O: Advance one frame (while paused)<\/li>\\n    <li>\\n      F: Frame Rate mode\\n      <ul>\\n        <li>\\n          Once enabled, press a number key to select from the preset target\\n          frame rates\\n        <\/li>\\n        <li>Press Left\/Right Arrow for fine tuning<\/li>\\n        <li>Press Q to quit Frame Rate mode<\/li>\\n      <\/ul>\\n    <\/li>\\n    <li>\\n      V: Toggle Synchronous mode (default: off)\\n      <ul>\\n        <li>\\n          When enabled, the threads of the animation will run synchronously\\n        <\/li>\\n        <li>\\n          Allows the animation to evolve in a deterministic way, at the cost of\\n          performance\\n        <\/li>\\n      <\/ul>\\n    <\/li>\\n  <\/ul>\\n<\/div>\\n',Ze='<div>\\n  <div>\\n    <h2>Help<\/h2>\\n    <div>\\n      <h3>Changing Over Time<\/h3>\\n      <p>\"because unless until\" outputs change over the course of time.<\/p>\\n      <ul>\\n        <li>\\n          Each output assigns 7 [of 18 possible] \"Coloring Modes\" to each of 8\\n          animation regions, that change throughout the week. This gives each\\n          day of the week a slightly different use of the colors in the output.\\n          <ul>\\n            <li>\\n              Each week, the Coloring Mode selections repeat in the same way for\\n              an output (e.g. every Monday uses the same coloring modes)\\n            <\/li>\\n            <li>\\n              Coloring Mode determines how the current state of automata is used\\n              to apply color palettes\\n            <\/li>\\n          <\/ul>\\n        <\/li>\\n      <\/ul>\\n      <ul>\\n        <li>\\n          Each output includes 31 \"Detail Levels\" that change throughout the\\n          month\\n          <ul>\\n            <li>\\n              Each month, the Detail Level selections repeat in the same way for\\n              an output (e.g. the 7th of every month has the same Detail Level)\\n            <\/li>\\n            <li>\\n              Detail Level affects how granular the animation is, changing the\\n              balance of automata and shapes\\n            <\/li>\\n          <\/ul>\\n        <\/li>\\n      <\/ul>\\n      <ul>\\n        <li>\\n          At the start of each month, each output\\'s structure will change\\n          <ul>\\n            <li>\\n              Each year, the appearance changes repeat in the same way for an\\n              output (e.g. April always has the same structure)\\n            <\/li>\\n            <li>Textures, colors, and other characteristics remain fixed<\/li>\\n          <\/ul>\\n        <\/li>\\n      <\/ul>\\n      <ul>\\n        <li>\\n          Each day at midnight, the animation will reset to align with the new\\n          day\\n        <\/li>\\n      <\/ul>\\n    <\/div>\\n    <div>\\n      <h3>Weekly Events<\/h3>\\n      <p>\\n        Some outputs behave in unusual ways on certain days of the week. How\\n        this manifests depends on the output.\\n      <\/p>\\n      <ul>\\n        <li>\\n          Shifty Sunday - Each color palette is shifted by a random amount, to\\n          use its colors in new ways\\n        <\/li>\\n        <li>\\n          Coloring Mode Monday - Gradually cycles through every possible\\n          coloring mode, changing how palettes are applied\\n        <\/li>\\n        <li>\\n          Alternative Tuesday - Color palettes are shifted, then mixed together\\n          -- creating new blends of color\\n        <\/li>\\n        <li>Weird Wednesday - Color palettes shift intermittently over time<\/li>\\n        <li>\\n          Automatic Thursday - Automata are randomly selected for the animation,\\n          instead of being selected based on the neighborhood features of the\\n          output (the neighborhood determines which neighbors of a cell\\n          influence its behavior)\\n        <\/li>\\n        <li>\\n          Festive Friday - Color palettes shift in hue, creating psychedelic\\n          color changes\\n        <\/li>\\n        <li>\\n          Solid Saturday - Automata are replaced with solid or empty fill, for a\\n          bolder appearance\\n        <\/li>\\n      <\/ul>\\n    <\/div>\\n  <\/div>\\n  <div>\\n    <h3>Yearly Events (Holidays)<\/h3>\\n    <p>Each output comes with a couple of special days.<\/p>\\n    <ul>\\n      <li>\\n        Fiesta Day - Each output comes with its own special day where colors and\\n        shapes shift rapidly\\n        <ul>\\n          <li>Combines the daily modes for Sunday, Monday, and Friday<\/li>\\n          <li>Increases the rate of automata changes<\/li>\\n          <li>Increases default framerate<\/li>\\n        <\/ul>\\n      <\/li>\\n    <\/ul>\\n    <ul>\\n      <li>\\n        Glitchmas - Every year, a new day in December is chosen as a shared\\n        holiday for all outputs\\n      <\/li>\\n      <ul>\\n        <li>\\n          The animation is flickery and distorted, like a pay-per-view channel\\n          with no subscription\\n        <\/li>\\n      <\/ul>\\n    <\/ul>\\n  <\/div>\\n<\/div>';const Ke=[];for(let t=0;t<25;t++)Ke.push(124+10*t);for(let t=1;t<=6;t++)Ke.push(364+14*t);const ti=a(),ei=[jt,Ut,Gt,Ht,Nt,Vt,Qt,Jt],ii=ei[B];let si=new ii;const ni=[[n(100,500),n(20,100),n(100,500)],[n(100,500),n(20,100),n(100,500)],[n(100,500),n(20,100),n(100,500)],[n(100,500),n(20,100),n(100,500)]];let ai,oi,hi,ri,li,ci,di,ui;const mi=18,fi=s(.005,.1),pi=at(17),gi=0,yi=30,bi=n(2,10);let wi,xi,Ai,ki,vi,Mi,Si,Oi,zi,Ci;const Ti=[[[0,6,12,21,25,43,44,46,47],[0,5,8,11,12,16,18,19,20,21,22,23,25,26,27,29,31,38,47,48,52],[12,18,19,20,21,22,23,25,26,27,31,32,33,45,46,47,48,50],[0,5,7,11,13,16,18,19,20,21,22,23,24,25,26,27,34,37,38,42,43,47,48,50,52],[11,16,19,20,21,22,23,24,25,26,27,28,33,37,52],[3,11,20,21,22,23,24,25,26,27,28,30,33,37,50],[0,5,6,7,10,11,16,18,20,21,23,30,36,41,42,47,48,51,52],[0,5,6,7,8,9,10,11,16,19,20,21,29,30,31,36,37,41,42,47,48,50,51,52],[0,1,5,6,7,8,11,16,18,20,21,22,25,29,30,32,36,38,40,41,42,46,47,48,51,52]],[[0,5,11,12,16,21,23,25,38,41,47,48],[5,7,10,11,29,42,47,48],[5,11,13,16,20,21,22,23,24,25,36,42,45,47,48,52],[5,11,13,16,21,22,25,36,47,48],[3,11,12,16,20,21,22,24,25,26,28,30,43,48,52],[11,20,21,22,25,28,30,32,52],[1,5,7,8,11,16,21,22,23,24,25,26,30,36,46,48,52],[5,7,8,9,10,11,16,17,19,21,22,25,26,36,47,48,52],[7,8,11,21,26,36,47,48]],[[5,22,25,27,30,32,37,39,43,44,48],[0,10,12,20,21,22,23,25,26,27,30,31,32,37,39,43,45,46,47,48,52],[7,20,21,47,48,52],[21,22,25,27,30,32,33,41,42,47,48,50],[11,12,16,20,22,27,28,29,33,42,44,50,52],[11,18,19,21,27,29,30,31,33,37,38,39,42,43,44,46],[0,1,5,6,7,8,9,10,12,13,17,19,21,23,24,31,32,36,39,40,41,47,48,51,52],[0,5,6,7,8,9,10,13,16,17,19,25,26,29,31,32,36,37,40,44,48,52],[5,7,8,11,13,16,17,18,19,20,25,31,32,37,39,41,42,43,44,48,51,52]],[[2,3,5,7,16,18,20,21,23,24,25,27,33,34,37,39,47,48,49,50,52],[5,11,16,20,23,24,25,34,39,47,52],[7,11,13,16,19,20,21,22,23,24,25,26,34,35,43,47,48,50,52],[13,16,20,21,22,23,24,25,26,35,47,48,50,52],[20,21,23,24,25,26,27,28,29,33,34,35,49,50,52],[12,21,23,26,27,28,30,33,34,35,49,50],[5,7,19,20,32,33,34,36,37,43,48,51],[5,6,7,8,9,11,16,17,20,21,31,33,34,36,38,41,44,45,47,48,51,52],[1,5,6,7,8,9,16,18,20,32,33,36,38,42,44,47,48,50,52]],[[5,16,21,22,26,29,38,42,47,48,50],[5,7,8,11,16,21,23,25,38,42,45,46,47,48,51,52],[5,7,11,12,16,18,20,23,25,30,32,38,42,47,48],[10,11,12,16,21,22,23,25,29,38,42,46,47,48],[7,11,12,16,19,20,22,23,25,27,28],[10,11,16,20,25,28,30,32,36,46,47,48,50],[1,5,7,8,9,11,16,20,21,24,25,26,32,36,38,42,47,48,52],[2,5,6,7,8,9,11,16,17,20,21,23,24,26,27,29,30,36,38,40,42,47,48,49,50,52],[3,5,8,11,16,21,23,29,30,35,36,38,42,47,48]],[[6,7,18,22,23,25,26,29,30,32,35,37,45,47,48,52],[6,11,20,21,22,23,24,25,26,29,30,31,47,48,51,52],[5,6,7,11,21,22,23,24,25,26,28,29,30,48,52],[5,6,11,12,16,21,22,23,24,25,29,30,36,47,48,49,51],[6,11,13,19,20,21,22,26,28,29,30,31,34,38,39,45,47,48,52],[3,6,10,11,12,13,16,18,20,21,22,23,24,25,26,28,29,30,34,48,50],[7,10,11,24,26,32,36,44,47,48],[2,5,6,7,8,9,10,11,16,18,23,26,29,36,40,43,47,48],[1,5,6,7,8,9,10,11,12,13,22,24,26,33,36,43,44,46,48,52]],[[0,1,4,5,7,8,9,11,12,16,20,25,26,30,34,36,38,40,42,44,47,48,52],[0,1,5,6,7,8,9,11,16,18,20,26,30,33,36,38,41,42,47,48,50,52],[0,5,7,8,11,12,13,20,22,29,30,36,38,42,44,47,48,52],[0,1,5,6,7,9,10,11,12,16,20,24,26,30,34,36,38,40,46,47,48,52],[0,1,5,6,7,9,12,16,20,30,36,48,52],[7,8,9,11,17,20,22,25,26,36,39,44,52],[0,1,5,6,7,8,9,11,17,20,23,29,36,38,42,44,47,48,52],[0,1,5,6,7,9,11,13,16,20,21,25,30,36,38,47,48,50],[0,2,3,5,6,7,8,9,10,11,12,16,19,20,24,25,29,30,36,38,40,43,47,48,52]]][D][I],Ri=[[[16,18,22,23,27,31,33,39],[32,37,39,43],[0,16],[12,31,32,39],[12],[12,19,52],[],[],[]],[[10,22,26,30,42,52],[7,10,23,25,27],[12],[],[],[16,26],[],[],[]],[[12,16,19,50],[18,19,50],[18,22,27],[19,38,39,43,45],[5,31,45],[12],[],[],[]],[[17,31,32,35,38,43,51],[35,36,37],[51],[18,19,33,34,45,46],[11,12,16,22,37,45,47],[25,39,43,46,47,52],[],[],[]],[[],[2,22,27],[6,21,52],[26,27],[4,21,48],[6,21,23,31,52],[],[],[]],[[],[36,49],[],[26],[12,37,49],[],[],[],[]],[[],[],[],[],[],[],[],[],[]]][D][I];let Ei;const Bi=a(),Di=s(.25,.75),Ii=a(),Li=a();let _i,Fi,Pi,Yi,Xi,$i,Wi,qi,Gi,Ni,Hi,ji,Ui,Ji,Vi,Qi,Zi,Ki,ts,es,is,ss=-1,ns=0,as=a(),os=s(.01,.4),hs=a(),rs=s(.5,1),ls=s(.5,.95);const cs=(t,e)=>+!!Ei[e][t],ds=()=>{let t,e;return t=Ke[yi],e=Ke[yi],[t,e]};let us=()=>{const[t,e]=ds();_i=[],pt(1+~~(e\/2),1+~~(t\/2),_i);for(let i=0;i<1+~~(e\/2);i++)for(let s=0;s<1+~~(t\/2);s++){let t=Bi?Di:Di*i\/(1+~~(e\/2));Ii&&(t=1-t),_i[i][s]=a(t)?0:1}},ms=()=>{if(us(),Fi!==dn||Pi!==ci){Fi=dn,Pi=ci,Ei=[],pt(Is,Ds,Ei);for(let t=0;t<1+~~(Is\/2);t++)for(let e=0;e<1+~~(Ds\/2);e++)Ei[t][e]=_i[t][e];if(Li){for(let t=0;t<1+~~(Is\/2);t++)for(let e=~~(Ds\/2);e<Ds;e++)Ei[t][e]=Ei[t][Ds-e-1];for(let t=1+~~(Is\/2);t<Is;t++)for(let e=0;e<Ds;e++)Ei[t][e]=Ei[Is-t-1][e]}else{for(let t=~~(Is\/2);t<Is;t++)for(let e=~~(Ds\/2);e<Ds;e++)Ei[t][e]=Ei[Is-t-1][Ds-e-1];for(let t=1+~~(Is\/2);t<Is;t++)for(let e=0;e<~~(Ds\/2);e++)Ei[t][e]=Ei[t][~~(Ds\/2)+e+1];for(let t=0;t<~~(Is\/2);t++)for(let e=1+~~(Ds\/2);e<Ds;e++)Ei[t][e]=Ei[Is-t-1][Ds-e-1]}}};const fs=(t,i)=>{let s,n;switch(D){case 0:s=[[t-1,i-1],[t-1,i],[t-1,i+1],[t,i-1],[t,i+1],[t+1,i-1],[t+1,i],[t+1,i+1]];break;case 1:s=[[t-1,i],[t-1,i+1],[t,i-1],[t+1,i],[t+1,i+1]],e.abs(~~(Ds\/2)-t)%8<3&&(s=[[t-1,i-1],[t-1,i],[t,i+1],[t+1,i-1],[t+1,i]]);break;case 2:s=[[t-1,i-1],[t-2,i-1],[t-1,i+1],[t+1,i-2],[t-1,i+2],[t+1,i-1],[t+2,i+1],[t+1,i+1]];break;case 3:s=[[t-1,i-1],[t-1,i],[t-1,i+1],[t,i-1],[t,i+1],[t+1,i-1],[t+1,i],[t+1,i+1],[t,i]];break;case 4:s=[[t-1,i-1],[t-1,i],[t,i-1],[t,i+1],[t+1,i-1],[t+1,i]],e.abs(~~(Ds\/2)-t)%8<3&&(s=[[t-1,i],[t-1,i+1],[t,i-1],[t,i+1],[t+1,i],[t+1,i+1]]);break;case 5:s=[[t-1,i],[t,i-1],[t,i+1],[t+1,i],[t,i]];break;case 6:s=[[t-1,i],[t,i-1],[t,i+1],[t+1,i],[t-2,i],[t,i-2],[t,i+2],[t+2,i]]}switch(I){case 0:n=[[t-2,i-2],[t-2,i-1],[t-2,i],[t-2,i+1],[t-2,i+2],[t-1,i-2],[t-1,i+2],[t,i-2],...ti?[[t,i]]:[],[t,i+2],[t+1,i-2],[t+1,i+2],[t+2,i-2],[t+2,i-1],[t+2,i],[t+2,i+1],[t+2,i+2]];break;case 1:n=[[t-2,i-2],[t+2,i+2],[t-2,i+2],[t+2,i-2],[t-3,i-3],[t-3,i-1],[t-3,i],[t-3,i+1],[t-3,i+3],[t-1,i-3],[t-1,i+3],[t,i-3],...ti?[[t,i]]:[],[t,i+3],[t+1,i-3],[t+1,i+3],[t+3,i-3],[t+3,i-1],[t+3,i],[t+3,i+1],[t+3,i+3]];break;case 2:n=[[t-3,i-3],[t-3,i-1],[t-3,i],[t-3,i+1],[t-3,i+3],[t-1,i-3],[t-1,i+3],[t,i-3],...ti?[[t,i]]:[],[t,i+3],[t+1,i-3],[t+1,i+3],[t+3,i-3],[t+3,i-1],[t+3,i],[t+3,i+1],[t+3,i+3]];break;case 3:n=[[t-3,i-3],[t-3,i-2],[t-3,i-1],[t-3,i],[t-3,i+1],[t-3,i+2],[t-3,i+3],[t-2,i-3],[t-2,i+3],[t-1,i-3],[t-1,i+3],[t,i-3],...ti?[[t,i]]:[],[t,i+3],[t+1,i-3],[t+1,i+3],[t+2,i-3],[t+2,i+3],[t+3,i-3],[t+3,i-2],[t+3,i-1],[t+3,i],[t+3,i+1],[t+3,i+2],[t+3,i+3]];break;case 4:n=[[t-2,i-2],[t-2,i-1],[t-2,i],[t-1,i-2],[t,i-2],...ti?[[t,i]]:[],[t+1,i-2],[t+2,i-2],[t+2,i-1],[t+2,i]],e.abs(~~(Ds\/2)-t)%8<3&&(n=[[t-2,i],[t-2,i+1],[t-2,i+2],[t-1,i+2],...ti?[[t,i]]:[],[t,i+2],[t+1,i+2],[t+2,i],[t+2,i+1],[t+2,i+2]]);break;case 5:n=[[t-2,i],[t-2,i+1],[t-2,i+2],[t-1,i+2],...ti?[[t,i]]:[],[t,i+2],[t+1,i+2],[t+2,i],[t+2,i+1],[t+2,i+2]],e.abs(~~(Ds\/2)-t)%8<3&&(n=[[t-2,i-2],[t-2,i-1],[t-2,i],[t-1,i-2],[t,i-2],...ti?[[t,i]]:[],[t+1,i-2],[t+2,i-2],[t+2,i-1],[t+2,i]]);break;case 6:n=[[t-4,i+3],[t-3,i-4],[t+3,i+4],[t+4,i-3],[t-2,i-1],[t-2,i-2],[t+1,i-2],[t+2,i-2],[t+2,i+1],[t+2,i+2],[t-1,i+2],[t-2,i+2],[t+3,i-1],[t-3,i+1],[t,i-3],[t,i+3]];break;case 7:n=[[t-2,i],[t-2,i+2],...ti?[[t,i]]:[],[t+2,i],[t+2,i+2],[t-3,i+3],[t+3,i+3],[t-4,i+1],[t+4,i+1],[t-3,i+2],[t+3,i+2],[t+1,i+1],[t+1,i+2],[t+2,i-1],[t-2,i-2],[t,i+4],[t-1,i+4]],e.abs(~~(Ds\/2)-t)%8<4&&(n=[[t-2,i-2],[t-2,i],...ti?[[t,i]]:[],[t+2,i-2],[t+2,i],[t-3,i-3],[t+3,i-3],[t-4,i-1],[t+4,i-1],[t-3,i-2],[t+3,i-2],[t-1,i-1],[t-1,i-2],[t-2,i+1],[t+2,i+2],[t,i-4],[t+1,i-4]]);break;case 8:n=[[t-4,i-1],[t-4,i],[t-4,i+1],[t-3,i-3],[t-3,i-2],[t-2,i-3],[t-3,i+3],[t-3,i+2],[t-2,i+3],[t-1,i-4],[t,i-4],[t+1,i-4],[t-1,i+4],[t,i+4],[t+1,i+4],[t+3,i-3],[t+3,i-2],[t+2,i-3],[t+3,i+3],[t+3,i+2],[t+2,i+3],[t+4,i-1],[t+4,i],[t+4,i+1]]}const a=([t,e])=>t>=0&&t<Ds&&e>=0&&e<Is;Zi[i][t]=[s.filter(a),n.filter(a)]},ps=()=>{zi=hi===P&&oi===X,[wi,xi,Ai,ki,vi,Mi,Si]=_.map(((t,e)=>(t&&ai===e||zi&&[0,1,5].includes(e))&&!Me&&Oe)),Ci=zi?s(8,20):s(3,31),Oi=11===hi&&oi===(24+7*li-1)%31+1&&Oe},gs=()=>{[ai,oi,hi,ri]=rt(Me),li=ri-2023;const t=mt(0,yi);void 0===ci&&(ci=t),[di,ui]=[0,0].map((()=>new Array(4).fill(0).map((()=>et(7,pi)[ai])))),ps()},ys=()=>{const[t,e]=ds();Ki=nt(at(t)),ts=nt(at(e))},bs=()=>{dn>1?(Ds=Ke[ci],Is=~~(Ds\/dn)):(Is=Ke[ci],Ds=~~(Is*dn)),Yi=1\/Ds,Xi=1\/Is,[qi,Wi]=[e.max(Is,Ds),e.min(Ds,Is)],$i=Ds*Is,Ui=.9*$i,Ji=.05*$i,Gi=zs*Yi,Ni=Cs*Xi,Hi=e.max(~~Gi,1),ji=e.max(~~Ni,1),ks.width=Ds,ks.height=Is,Ls=~~(Hi*Ds),_s=~~(ji*Is);const t=zs-Ls;Fs=.5*t,Ps=t-Fs;const i=Cs-_s;Ys=.5*i,Xs=i-Ys,Ss=xs.createImageData(Ds,Is),vs=Ss.data,js?(Ts=Fs,Rs=Ys,Es=Ls,Bs=_s):(Ts=0,Rs=0,Es=zs,Bs=Cs),ys(),is=Ki.filter((t=>t<Ds)),es=ts.filter((t=>t<Is));const s=\"Merry Glitchmas!\".split(\"\").map(((t,e)=>`<span style=\"color:${e%2?\"red\":\"green\"}; font-size: ${n(16,25)}px\">${t}<\/span>`)).join(\"\");const a=(t=>t.split(\"\").map(((t,e)=>`<span style=\"color:rgb(${n(50,255)},${n(50,255)},${n(50,255)});\">${t}<\/span>`)).join(\"\"))(\"It's Time for a Fiesta!\");Je=`<div><h2>Today<\/h2><div><p>Detail Level: ${ci+1}\/31<\/p>`+(Me?\"<p><b>Special Day content is not available in Canonical mode!<\/b><\/p>\":`${Oi?`<h3>${s}<\/h3>`:\"\"}\\n${zi?`<h3>${a}<\/h3>`:\"\"}\\n<h2>Weekly Events<\/h2>\\n<ul>\\n${_[0]?`<li>Shifty Sunday: ${wi?\"ON\":\"OFF\"}<\/li>`:\"\"}\\n${_[1]?`<li>Coloring Mode Monday: ${xi?\"ON\":\"OFF\"}<\/li>`:\"\"}\\n${_[2]?`<li>Alternative Tuesday: ${Ai?\"ON\":\"OFF\"}<\/li>`:\"\"}\\n${_[3]?`<li>Weird Wednesday: ${ki?\"ON\":\"OFF\"}<\/li>`:\"\"}\\n${_[4]?`<li>Automatic Thursday: ${vi?\"ON\":\"OFF\"}<\/li>`:\"\"}\\n${_[5]?`<li>Festive Friday: ${Mi?\"ON\":\"OFF\"}<\/li>`:\"\"}\\n${_[6]?`<li>Solid Saturday: ${Si?\"ON\":\"OFF\"}<\/li>`:\"\"}\\n<\/ul>\\n<h2>Annual Events (Holidays)<\/h2>\\n<p>Get your party hat on for Fiesta Day on <u>${A[P]} ${X}<\/u><\/p>\\n<p>Glitchmas comes but once each year! This year (${ri}), it arrives on <u>December ${(24+7*li-1)%31+1}<\/u><\/p>`)+\"<\/div><\/div>\"};let ws,xs,As,ks,vs,Ms,Ss,Os,zs,Cs,Ts,Rs,Es,Bs,Ds,Is,Ls,_s,Fs,Ps,Ys,Xs,$s,Ws,qs,Gs,Ns=window.devicePixelRatio||1,Hs=!1,js=!1,Us=!1,Js=!1,Vs=!1,Qs=!1,Zs=!1;const Ks=\"f\",tn=\"d\",en=\"a\",sn=[1e3,1,2,6,12,15,24,50,60,120],nn=[[0,0],[16,9],[9,16],[4,3],[3,4],[2,1],[1,2],[3,1],[1,3],[1,1]],an=nn[1],on=an[0]\/an[1];let hn,rn,ln,cn,dn=on,un=1,mn=an,fn=30,pn=!!document.fullscreenElement,gn=0,yn=30,bn=40,wn=yn-bn,xn=wn;const An=.1,kn=[.05,An],vn=[.05,.05];let Mn=[.68,.16];const Sn=[1,1,1],On=[kn,vn,Mn,Sn],zn=n(On.length),[Cn,Tn]=On[zn],Rn=1\/s(1,10);e.max(.5,e.min(4*Tn,Tn+.15));const En=.94;let Bn=e.min(s(3===zn?.85:.7,En),En);const Dn=1-Bn,In=()=>{ws.save(),xs.save(),ws.globalAlpha=1,xs.globalAlpha=1,Wn(1,ws),Wn(1,xs),ws.restore(),xs.restore()},Ln=t=>{xn=6*e.sqrt(h(1,100,fn)),cn=t},_n=()=>{const t=[\"ms\",\"moz\",\"webkit\",\"o\"];for(let e=0;e<t.length&&!window.requestAnimationFrame;++e)window.requestAnimationFrame=window[t[e]+\"RequestAnimationFrame\"],window.cancelAnimationFrame=window[t[e]+\"CancelAnimationFrame\"]||window[t[e]+\"CancelRequestAnimationFrame\"]},Fn=s=>{s&&(i=new t(tokenData)),gn=0,Hs=!1,Ns=window.devicePixelRatio||1,document.documentElement.style.backgroundColor=\"black\",document.body.style.backgroundColor=\"black\",As=As||document.createElement(\"canvas\"),As.style.margin=\"auto\",Zn(mn),Os=e.min(window.innerWidth,window.innerHeight),window.innerHeight<window.innerWidth?dn>1?window.innerWidth>=Os*dn?(zs=Os*dn,Cs=Os):(zs=window.innerWidth,Cs=zs\/dn):(zs=Os*dn,Cs=Os):dn>1?(zs=Os,Cs=Os\/dn):window.innerHeight<Os\/dn?(Cs=window.innerHeight,zs=Cs*dn):(zs=Os,Cs=Os\/dn),zs=(pn?window.innerWidth:zs)*Ns,Cs=(pn?window.innerHeight:Cs)*Ns,As.width=zs,As.height=Cs,As.style.width=zs\/Ns+\"px\",As.style.height=Cs\/Ns+\"px\",ws=As.getContext(\"2d\",{colorSpace:\"display-p3\",alpha:!1}),Ms=ws.createImageData(zs,Cs),ws.putImageData(Ms,0,0),ws.imageSmoothingEnabled=ws.mozImageSmoothingEnabled=ws.oImageSmoothingEnabled=ws.webkitImageSmoothingEnabled=!1,ks=document.createElement(\"canvas\"),xs=ks.getContext(\"2d\",{colorSpace:\"display-p3\",alpha:!1}),xs.imageSmoothingEnabled=xs.mozImageSmoothingEnabled=xs.oImageSmoothingEnabled=xs.webkitImageSmoothingEnabled=!1,ws.globalAlpha=Rn,xs.globalAlpha=Rn,ws.save(),xs.save(),ws.globalAlpha=1,xs.globalAlpha=1,Wn(1,ws),Wn(1,xs),ws.restore(),xs.restore(),la()};let Pn;document.addEventListener(\"DOMContentLoaded\",(()=>{Fn(!0),Qn((zn>1||Bn<.9?16:24)*(zi?1.5:1),!0),document.body.appendChild(As),window.addEventListener(\"keydown\",ra,!1),_n(),requestAnimationFrame($n)}));const Yn=(t=!0)=>{Us=!0,clearTimeout(Pn),Pn=setTimeout((()=>{ca?Yn(t):(Us=!1,Fn(t))}),150)};w||window.addEventListener(\"resize\",Yn);const Xn=()=>{ws.drawImage(ks,0,0,Ds,Is,Ts,Rs,Es,Bs)},$n=async()=>{if(!Us||Js){if(!w){const t=ln||performance.now();ln=performance.now(),hn=e.max(0,hn+rn-ln+t)}Se||!gn?(await da(),await ua()):(da(),ua()),gn++,Js&&(Js=!1)}ws.drawImage(ks,0,0,Ds,Is,Ts,Rs,Es,Bs),xn>wn&&(ws.save(),ws.globalAlpha=1,ws.fillStyle=`rgba(${xn>0?\"50,50,50\":\"0,0,0\"},${xn>0?.6:js?.4:.1*(xn-wn)})`,ws.fillRect(0,Cs*(xn<=0&&js?.95:.96),zs,Cs*(xn<=0&&js?.05:.04)),xn=e.max(wn,xn-1),xn>0&&(ws.fillStyle=`rgba(255,255,255,${xn>yn\/3?1:.1*xn})`,ws.font=e.max(zs,Cs)\/60+\"px Verdana\",ws.fillText(cn,.01*zs,.985*Cs)),ws.restore()),setTimeout((()=>{requestAnimationFrame($n)}),hn)},Wn=(t,i)=>{const s=t?e.max(t,.03):1;i.fillStyle=`rgba(0,0,0,${s})`,i.fillRect(0,0,zs,Cs)},qn=()=>{Us=!Us,Us||(ln=performance.now()),Ln((Us?\"\":\"un\")+\"paused\")},Gn=()=>{Me=!Me,ci=void 0,Ln(\"Canonical mode set to: \"+(Me?\"On\":\"Off\")),Yn()},Nn=()=>{Se=!Se,Ln(\"Synchronous mode set to: \"+(Se?\"On\":\"Off\")),Yn()},Hn=()=>{Me||Oe&&![wi,xi,Ai,ki,vi,Mi,Si].some((t=>t))&&!Oi||(Oe=!Oe,Ln(\"Special Day set to: \"+(Oe?\"On\":\"Off\")),ps(),Yn())},jn=()=>{js=!js,Ln(\"Display mode set to: \"+(js?\"Perfect Pixel\":\"Stretch\")),Yn()},Un=()=>{ze=!ze,Ln(`Pattern changes ${ze?\"\":\"un\"}paused`)},Jn=(t,e)=>{Gs=t,Ln(`Set mode to ${e}`)},Vn=()=>{const t=document.createElement(\"a\");t.download=`export_${tokenData.tokenId}_${ht(Me).toISOString()}.png`,t.href=As.toDataURL(),t.click(),t.remove()},Qn=(t,i=!1)=>{let s;if(fn=t,fn>=1)rn=1e3\/fn,s=fn;else{const t=1\/(2-fn);rn=1e3\/t,s=t}hn=rn,Us=!1,yn=30*e.sqrt(fn)\/5,bn=35*e.sqrt(fn)\/5,wn=yn-bn,i||Ln(`Setting Target FPS to ${1e3===t?\"unlimited\":s}`)},Zn=t=>{const i=0===t[0]&&0===t[1];dn=i?e.max(window.innerWidth\/window.innerHeight,x?.6:window.innerWidth\/window.innerHeight):t[0]\/t[1]},Kn=(t=!1)=>{const e=nn[un],i=0===e[0]&&0===e[1];mn=e,Yn(),t||Ln(\"Setting Aspect Ratio to \"+(i?\"Responsive\":`${e[0]}:${e[1]}`))},ta=()=>{document.body.requestFullscreen?document.body.requestFullscreen():document.body.webkitRequestFullScreen?document.body.webkitRequestFullScreen():document.body.mozRequestFullScreen&&document.body.mozRequestFullScreen()},ea=t=>{const e=pn?zs:Os,i=pn?Cs:Os,s=document.createElement(\"div\");return s.width=18*e\/20+\"px\",s.height=18*i\/20+\"px\",s.style.fontFamily=\"Verdana, sans-serif\",s.style.background=\"rgba(40,40,40,0.9)\",s.style.color=\"white\",s.style.position=\"absolute\",s.style.left=e\/20+\"px\",s.style.top=i\/20+\"px\",s.style.right=e\/20+\"px\",s.style.bottom=i\/20+\"px\",s.style.padding=`${i\/20}px ${e\/20}px`,s.style.border=\"solid #777 4px\",s.style.overflow=\"auto\",s.innerHTML=Ve+t,document.body.appendChild(s),s},ia=()=>{Vs||($s=ea(Ze),Vs=!0)},sa=()=>{$s&&$s.remove(),Vs=!1},na=()=>{Qs||(Ws=ea(Qe),Qs=!0)},aa=()=>{Ws&&Ws.remove(),Qs=!1},oa=()=>{Zs||(qs=ea(Je),Zs=!0)},ha=()=>{qs&&qs.remove(),Zs=!1},ra=t=>{const e=t.key;if(\"h\"===e||\"Escape\"===e){if(Vs)return void sa();if(Qs)return void aa();if(Zs)return void ha()}if(!(Vs||Qs||Zs)){switch(e){case\"c\":Me=!Me,ci=void 0,Ln(\"Canonical mode set to: \"+(Me?\"On\":\"Off\")),Yn();break;case\"d\":Me||Oe&&![wi,xi,Ai,ki,vi,Mi,Si].some((t=>t))&&!Oi||(Oe=!Oe,Ln(\"Special Day set to: \"+(Oe?\"On\":\"Off\")),ps(),Yn());break;case\"v\":Se=!Se,Ln(\"Synchronous mode set to: \"+(Se?\"On\":\"Off\")),Yn();break;case\"g\":ze=!ze,Ln(`Pattern changes ${ze?\"\":\"un\"}paused`);break;case\"t\":js=!js,Ln(\"Display mode set to: \"+(js?\"Perfect Pixel\":\"Stretch\")),Yn();break;case\"h\":oa();break;case\"m\":document.body.requestFullscreen?document.body.requestFullscreen():document.body.webkitRequestFullScreen?document.body.webkitRequestFullScreen():document.body.mozRequestFullScreen&&document.body.mozRequestFullScreen();break;case\"o\":Us&&(Js=!0,Ln(`advancing to frame ${gn+1}`));break;case\"p\":Us=!Us,Us||(ln=performance.now()),Ln((Us?\"\":\"un\")+\"paused\");break;case\"s\":Vn();break;case\"q\":Gs=void 0,Ln(\"mode cleared\");break;case\"f\":Jn(Ks,\"Frame Rate\");break;case\"x\":Ne&&!Me||Jn(tn,\"Detail Level\");break;case\"a\":Jn(en,\"Aspect Ratio\");break;case\"ArrowLeft\":switch(Gs){case Ks:Qn(fn-1);break;case tn:if(Ne&&!Me)return;Hs?ci>0?(ci--,Ln(`Detail Level is now ${ci+1}`),Yn()):Ln(\"Detail Level can't go lower than 1\"):Ln(\"Detail reset in progress. Please try again in a second.\");break;case en:un=(un+9)%10,Kn()}break;case\"ArrowRight\":switch(Gs){case Ks:fn<1e3?Qn(fn+1):Ln(\"Target frame rate can't go higher than 999\");break;case tn:if(Ne&&!Me)return;Hs?ci<yi?(ci++,Ln(`Detail Level is now ${ci+1}`),Yn()):Ln(\"Detail Level can't go higher than 31\"):Ln(\"Detail reset in progress. Please try again in a second.\");break;case en:un=(un+11)%10,Kn()}}if(1*e<10)switch(Gs){case Ks:Qn(sn[1*e]);break;case en:un=1*e,Kn()}}},la=()=>{ct=performance.now(),gs(),[M,S,O]=we(),bs(),ns=0,Vi=void 0,ss=-1,ft=[],pt(qi,Wi),Qi=[],pt(qi,Wi,Qi),Zi=[],pt(qi,Wi,Zi),ms();for(let i=0;i<Is;i++)for(let s=0;s<Ds;s++)ft[i][s]={alive:(t=s,e=i,+!!Ei[e][t])},fs(s,i);var t,e;if(si.animationsExecutedAtLeastOnce=!1,si.initAutomata(),si.primeAutomata(),si.genEnsureAutoRands(),!Me)for(let t=0;t<hi*bi;t++)a();si.initAnimations(Ds,Is),M=S.map((t=>JSON.parse(t))),Hs=!0,si.ensureAutomataBalance()};let ca=!1;const da=async()=>{ca=!0;const[t]=rt(Me);if(!w&&t!==ai)return ci=void 0,ca=!1,void Yn();ki&&M.forEach(((t,e)=>{const[i,s,n]=ni[e];gn%n<s&&(gn%i<s^Ge[1]%2==0?st:it)(t)})),Mi&&(M=M.map(((t,e)=>t.map((t=>vt(t,4+Ci*e))))));const i=xi?gn*fi:0;Se||!gn?await si.updateAnimations():si.updateAnimations(),si.shiftAutomata();let s=0;for(let t=0;t<Is;t++){let e=Zi[t],n=ft[t];for(let a=0;a<Ds;a++){let[o,h]=e[a];const r=o.length,l=h.length;let c=0,d=0,u=0;for(let t=o.length-1;t>-1;t--){const e=o[t];ft[e[1]][e[0]].alive&&c++}for(let t=h.length-1;t>-1;t--){const e=h[t];ft[e[1]][e[0]].alive&&d++}u=c+d;let m=u\/(r+l),f=c\/r,p=d\/l,{alive:g}=n[a];s+=g;let[y,b]=si.checkAnimationSetStateAt(a,t);b%=4;const w=Zt(g,(y?ve:ke)[b],c,d,u,f,p,m);let[x,A,k]=[0,0,0];if(w){const t=~~((y?ui:di)[b]+i)%mi;let e;const s=[f,p,m];switch(t){case 0:case 1:case 2:e=s[t%3];break;case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:e=s[t%3]*s[~~((t-3)\/3)];break;case 12:case 13:case 14:e=.5*(s[t%3]+s[(t+1)%3]);break;case 15:case 16:case 17:e=.5*(s[t%3]+s[(t+1)%3]*s[(t+2)%3])}let n=Math.round((Kt-1)*e),a=O[b][n];[x,A,k]=M[b][a]}Qi[t][a]={alive:w,neighbors:c,0:x,1:A,2:k}}}if(!ze&&(e.abs(s-ss)<10&&(void 0===Vi||s<Vi+1e3)?(void 0===Vi&&(Vi=ss),ns++):(ns=0,Vi=void 0),ss=s,si.animationsExecutedAtLeastOnce&&gn>5&&(s>Ui?Si?si.updateAutoModes(n(ke.length),a()):si.resetAutomata(\"death\"):s<Ji&&(!Si&&s>0?si.resetAutomata(\"growth\",!0):si.updateAutoModes(n(ke.length),a()))),(ns>25||0===s&&si.animationsExecutedAtLeastOnce)&&!Si)){if(0===s||ns>30)return ns=0,Yn(!1),void(ca=!1);si.resetAutomata(\"growth\",!0)}[ft,Qi]=[Qi,ft],ca=!1},ua=()=>{let t=0;if(Oi){gn%31>17&&st(es),gn%53<19&&it(es);let i=0;for(let s=0;s<Is;s++){let o=as&&a(ls)?es[s]:s;const r=ft[o];hs&&a(os)&&(as=!as);let l=0;Ge[10]%3<2&&(l=a(.1)?-e.sign(i):i<-2?n(2)-1:i>2?n(2)-2:n(3)-1,a(.1)&&(l=-i),i+=l);for(let e=l;e<Ds;e++){!hs&&a(os)&&(as=!as);let i=as||a(1-rs)||(e*(s-e)+gn)%s\/(e+s)>(e*e+s+gn)%e\/(s+e)?e:is[h(0,Ds,e)];const n=r[h(0,Ds,i)];vs[t]=vs[t++]*Bn+n[0]*Dn,vs[t]=vs[t++]*Bn+n[1]*Dn,vs[t]=vs[t++]*Bn+n[2]*Dn,vs[t++]=255}}}else for(let e=0;e<Is;e++){const i=ft[e];for(let e=0;e<Ds;e++){const s=i[e];vs[t]=vs[t++]*Bn+s[0]*Dn,vs[t]=vs[t++]*Bn+s[1]*Dn,vs[t]=vs[t++]*Bn+s[2]*Dn,vs[t++]=255}}xs.putImageData(Ss,0,0),xs.globalCompositeOperation=\"screen\",xs.drawImage(ks,0,0,Ds,Is,0,0,Ds,Is),xs.globalCompositeOperation=\"source-over\"};"
}