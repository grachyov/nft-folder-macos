{
  "abId" : "162",
  "address" : "0xa7d8d9ef8d8ce8992df33d8b8cf4aebabd5bd270",
  "instructions" : "Click & drag to pan|Scroll wheel to zoom in and out|\"c\" - Change camera mode|\"r\" - Reset camera positioning|\"p\" - Toggle auto-pan|\"z\" - Zoomed out view|\"t\" - Toggle background transparency|1-4 - Change detail level.",
  "kind" : "three",
  "name" : "Democracity",
  "screensaverFileName" : "Democracity",
  "value" : "const f=4095;const C=t=>.5*(1-Math.cos(t*Math.PI));let E;function r(t,e=0,i=0){if(null==E){E=new Array(1+f);for(let t=0;t<1+f;t++)E[t]=R()}t<0&&(t=-t),e<0&&(e=-e),i<0&&(i=-i);let s=Math.floor(t),h=Math.floor(e),o=Math.floor(i),n=t-s,a=e-h,r=i-o;var l,p;let c=0,d=.5;for(let t=0;t<4;t++){var u=s+(h<<4)+(o<<8),m=C(n),M=C(a),w=E[u&f];w+=m*(E[u+1&f]-w),l=E[u+16&f],w+=M*((l+=m*(E[u+16+1&f]-l))-w),u+=256,l=E[u&f],l+=m*(E[u+1&f]-l),p=E[u+16&f],l+=M*((p+=m*(E[u+16+1&f]-p))-l),w+=C(r)*(l-w),c+=w*d,d*=.5,s<<=1,n*=2,h<<=1,a*=2,o<<=1,r*=2,1<=n&&(s++,n--),1<=a&&(h++,a--),1<=r&&(o++,r--)}return c}const l=function(t,e,i,s,h){return(t-e)\/(i-e)*(h-s)+s};function z(t,e){return e?Number(Math.round(t+\"e\"+e)+\"e-\"+e):Math.round(t)}const e=[];for(let t=0;t<32;t++)e.push(tokenData.hash.slice(2+2*t,4+2*t));const p=e.map(t=>parseInt(t,16));!function(t){const e=(()=>{const e=4294967296;let i,s;return{setSeed(t){s=i=(null==t?R()*e:t)>>>0},getSeed(){return i},rand(){return s=(1664525*s+1013904223)%e,s\/e}}})();e.setSeed(t),E=new Array(1+f);for(let t=0;t<1+f;t++)E[t]=e.rand()}(parseInt(tokenData.hash.slice(2,10),16)),S=Uint32Array.from([0,1,s=t=2,3].map(t=>parseInt(tokenData.hash.substr(8*t+2,8),16))),R=e=>(t=S[3],S[3]=S[2],S[2]=S[1],S[1]=s=S[0],t^=t<<11,S[0]^=t^t>>>8^s>>>19,S[0]\/2**32);const y=new THREE.Scene,n=120,k=n\/240,b=n\/40,W=n\/n;let i=window.innerWidth\/window.innerHeight,a=!0;const h=1.5*n;var o=Rt(p[1]);let c;c=o<.4?n\/4:o<.8?n\/8:n\/16;let d=c;const u=new THREE.PerspectiveCamera(75,i,.1,7*n),m=new THREE.OrthographicCamera(-d*i,d*i,d,-d,1,3*n);let M=a?m:u;const w=\"mixed\",g=Rt(p[13]),x=[.25,.5,1];let v=[.28,.56,.84,1];g<.6&&(x.push(0),v=[.25,.5,.75,.85,1]);o=[...x,w];function T(t){var e=Object.keys(t);return t[e[e.length*R()<<0]]}function H(t,e){var i=Object.keys(t);return t[i[(i.length-1e-9)*Rt(p[e])<<0]]}function I(t,e,i){var s=Rt(p[t]);for(let t=0;t<e.length;t++)if(s<=e[t])return i[t]}const P=H({BW:[1315860,15987699],REEF:[867683,1938037,2471875,15721901,14897443],BRICK:[5649953,13585211,15515822,10852495,13996659],DOLPHIN:[1126479,3560792,7192023,14213854,16711421],OAXACA:[14964526,1556155,3024938,16438096,7778369],WHO_ATE_THE_CRANS:[16752562,16506082,708095,6335386,10582712],MOSS_AGATE:[16120815,9612692,7637877,13037440,5258562],FIREWATER:[15770114,5775128,15828997,14245177,2108505],BRINKMAN:[15885963,2344921,4774308,15908647,7960952],TOMATO_TOMATO:[7829180,13486053,16776155,16772177,16738125],THE_PINK_ONE:[7816112,6440803,12988005,16364497,14039801],DROPDOWN:[15385653,3430805,14942310,249508,16469309]},0),D=I(10,v,o),B=new THREE.WebGLRenderer({powerPreference:\"high-performance\",antialias:!0,alpha:!0});let A=!1;const X=new THREE.Color(O());function L(t,e){return R()*(e-t)+t}B.setSize(window.innerWidth,window.innerHeight),B.shadowMap.enabled=!0,B.shadowMap.autoUpdate=!1,B.shadowMap.needsUpdate=!0,B.shadowMap.type=THREE.PCFSoftShadowMap,document.body.appendChild(B.domElement),function(t,i){const e=document.body.querySelectorAll(t);e.forEach(e=>{Object.keys(i).forEach(t=>{e.style[t]=i[t]})})}(\"canvas\",{touchAction:\"none\",cursor:\"pointer\",\"-webkit-tap-highlight-color\":\"transparent\"});const G=[];function O(t,e=D){return!t||R()<e?P[Math.floor(R()*P.length)]:t}class Z{constructor(t,e,i,s,h,o,n,a){this.x=t,this.z=e,this.width=i,this.depth=s,this.boxes=[],this.colorCohesion=D===w?x[Math.floor(R()*x.length)]:D,this.stepBackPercent=R(),this.repeatWidth=h,this.repeatDepth=o,this.numRepeatWidth=n,this.numRepeatDepth=a}display(){this.boxes=this.makeStructure(this.x,this.z,this.width,this.depth,0,null,0,this.repeatWidth,this.repeatDepth,this.numRepeatWidth,this.numRepeatDepth,!1)}makeStructure(h,o,n,a,r,l,p=0,c=[],d=[],u=[],m=[],t){var e=R();let{splitWidthChance:i,splitDepthChance:s,splitRepeatChance:M,splitWhere:w,createLevelChance:f,numRepetitionsX:C,numRepetitionsZ:E}=tt.attributes.buildingSplitChances(h,o,n,a,p);t&&(t=i,y=s,g=M,x={splitWidthChance:t+=(x=t\/(t+y))*g,splitDepthChance:y+=(1-x)*g,splitRepeatChance:g=0},i=x.splitWidthChance,s=x.splitDepthChance,M=x.splitRepeatChance);var y=i+s,g=e<=i,x=e<=y&&e>i,y=e<=y+M&&y<e;let b=[];if(g&&n>k){e=this.makeStructure(h,o,n*w,a,r,l,p,c,d,u,m,!1),g=this.makeStructure(h+n*w,o,n*(1-w),a,r,l,p,c,d,u,m,!1);b=[...e,...g]}else if(x&&a>k){var v=this.makeStructure(h,o,n,a*w,r,l,p,c,d,u,m,!1),T=this.makeStructure(h,o+a*w,n,a*(1-w),r,l,p,c,d,u,m,!1);b=[...v,...T]}else if(y&&a>k&&n>k){var H,S=n\/C,I=a\/E,P=this.makeStructure(h,o,S,I,r,l,p,[...c,S],[...d,I],[...u,C],[...m,E],!0);for(let i=0;i<C;i++)for(let e=0;e<E;e++)for(let t=0;t<P.length;t++)0===i&&0===e||((H=P[t]).width>S&&0<i||H.depth>I&&0<e||(b.push({x:H.x+S*i,y:H.y,z:H.z+I*e,width:H.width,height:H.height,depth:H.depth,color:H.color}),H=new THREE.Color(H.color),G.push(H.r),G.push(H.g),G.push(H.b)));b=[...P,...b]}else{v=tt.attributes.buildingHeightGenerator(h,r,o,n,a,p),T=O(l,this.colorCohesion);let t=n,e=c.length-1;for(;z(t,10)===z(c[e],10);)t*=u[e],e--;let i=a;for(e=d.length-1;z(i,10)===z(d[e],10);)i*=m[e],e--;y={x:h+t\/2,y:r+v\/2,z:o+i\/2,width:t,height:v,depth:i,color:T},l=new THREE.Color(T);G.push(l.r),G.push(l.g),G.push(l.b);let s=[];n>W&&a>W&&R()<=f?R()<this.stepBackPercent||tt.type===Q.MONOLITH&&p<5?(l=Math.min(n,a)\/Math.floor(L(10,20)),s=this.makeStructure(h+l,o+l,n-2*l,a-2*l,v+r,T,p+1,c,d,u,m,!1),_(h,r,o,t,i,v,s)):s=this.makeStructure(h,o,n,a,v+r,T,p+1,c,d,u,m,!1):_(h,r,o,t,i,v,s),b=[y,...s]}return b}}function _(t,e,i,s,h,o,n){var a=L(.02,.06);et.weather.snow&&e+o>et.weather.flood.waterDepth&&e+o+a>et.weather.flood.waterDepth+et.weather.flood.snowHeight&&R()<.7&&(n.push({x:t+s\/2,y:e+o+a\/2,z:i+h\/2,width:s,height:a,depth:h,color:15592941}),h=new THREE.Color(15592941),G.push(h.r),G.push(h.g),G.push(h.b))}class Y{constructor(t,e,i,s){this.x=t,this.z=e,this.width=i,this.depth=s,this.boxes=[]}display(){this.splitBlock(this.x,this.z,this.width,this.depth)}splitBlock(t,e,i,s,h=0){var o=R(),{splitWidthChance:n,splitDepthChance:a,splitRepeatChance:r,splitWhere:l,numRepetitionsX:p,numRepetitionsZ:c}=tt.attributes.blockSplitChances(t,e,i,s,h),d=n+a,a=o<=d&&n<o,d=o<=d+r&&d<o;if(o<=n&&i>k)this.splitBlock(t,e,i*l,s,h+1),this.splitBlock(t+i*l,e,i*(1-l),s,h+1);else if(a&&s>k)this.splitBlock(t,e,i,s*l,h+1),this.splitBlock(t,e+s*l,i,s*(1-l),h+1);else if(d&&s>k&&i>k){var u=i\/p,m=s\/c;const f=new Z(t,e,u,m,[u],[m],[p],[c]);f.display();var M,w=f.boxes;const C=[];for(let i=0;i<p;i++)for(let e=0;e<c;e++)for(let t=0;t<w.length;t++)0===i&&0===e||((M=w[t]).width>u&&0<i||M.depth>m&&0<e||(C.push({x:M.x+u*i,y:M.y,z:M.z+m*e,width:M.width,height:M.height,depth:M.depth,color:M.color}),M=new THREE.Color(M.color),G.push(M.r),G.push(M.g),G.push(M.b)));this.boxes=[...this.boxes,...w,...C]}else{const E=new Z(t,e,i,s);E.display(),this.boxes=[...this.boxes,...E.boxes]}}}class F{constructor(t,e,i,s,h){this.x=t,this.z=e,this.width=i,this.depth=s,this.color=h,this.types={SQUARE:\"square\",PYRAMID:\"pyramid\",STAGE:\"stage\"},this.type=H(this.types,12)}display(){if(this.type===this.types.SQUARE){var t=new THREE.BoxBufferGeometry(this.width,1e3,this.depth),e=new THREE.MeshStandardMaterial({color:this.color});const h=new THREE.Mesh(t,e);h.receiveShadow=!0,h.position.x=this.x+this.width\/2,h.position.z=this.z+this.depth\/2,h.position.y=-500,y.add(h)}else if(this.type===this.types.PYRAMID){var i=new THREE.ConeGeometry(this.width*Math.sin(Math.PI\/4),50,4),s=new THREE.MeshStandardMaterial({color:this.color});const o=new THREE.Mesh(i,s);o.receiveShadow=!0,o.rotation.x=Math.PI,o.rotation.y=Math.PI\/4,o.position.x=this.x+this.width\/2,o.position.y=-25,o.position.z=this.z+this.depth\/2,y.add(o)}else if(this.type===this.types.STAGE){i=this.width*Math.sin(Math.PI\/4),s=new THREE.CylinderGeometry(i,.15*i,50,4),i=new THREE.MeshStandardMaterial({color:this.color});const n=new THREE.Mesh(s,i);n.receiveShadow=!0,n.rotation.y=Math.PI\/4,n.position.x=this.x+this.width\/2,n.position.y=-25,n.position.z=this.z+this.depth\/2,y.add(n)}}}class N{constructor(t,e,i,s){this.x=t,this.z=e,this.width=i,this.depth=s,this.boxes=[],this.baseColor=O()}display(){this.subdivideStreets(this.x,this.z,this.width,this.depth);const t=new F(this.x,this.z,this.width,this.depth,this.baseColor);t.display()}subdivideStreets(t,e,i,s,h=0){var o=R(),n=tt.attributes.streetSizeGenerator(h),{splitWidthChance:a,splitDepthChance:r,splitRepeatChance:l,splitChoices:p,numRepetitionsX:c,numRepetitionsZ:d}=tt.attributes.streetGenerationChances(t,e,i,s,h,n),u=a+r,r=o<=a,a=o<=u&&a<o,o=o<=u+l&&u<o,p=p[Math.floor(R()*p.length)];if(r&&i>b){if(0===h&&2<=n){const C=new j(t+i*p,e+s\/2,n,s);this.boxes=C.display()}this.subdivideStreets(t,e,i*p-n\/2,s,h+1),this.subdivideStreets(t+i*p+n\/2,e,i*(1-p)-n\/2,s,h+1)}else if(a&&s>b){if(0===h&&2<=n){const E=new j(t+i\/2,e+s*p,i,n);this.boxes=E.display()}this.subdivideStreets(t,e,i,s*p-n\/2,h+1),this.subdivideStreets(t,e+s*p+n\/2,i,s*(1-p)-n\/2,h+1)}else if(o&&s>b&&i>b){var m=(i-n*(c-1))\/c,M=(s-n*(d-1))\/d;const y=new Y(t,e,m,M);y.display();var w,f=y.boxes;const g=[];for(let i=0;i<c;i++)for(let e=0;e<d;e++)for(let t=0;t<f.length;t++)0===i&&0===e||(w=f[t],g.push({x:w.x+(m+n)*i,y:w.y,z:w.z+(M+n)*e,width:w.width,height:w.height,depth:w.depth,color:w.color}),w=new THREE.Color(w.color),G.push(w.r),G.push(w.g),G.push(w.b));this.boxes=[...this.boxes,...f,...g]}else{const x=new Y(t,e,i,s);x.display(),this.boxes=[...this.boxes,...x.boxes]}}}class j{constructor(t,e,i,s){this.x=t,this.z=e,this.color=O(),this.direction=s<i?1:0,this.streetSize=Math.min(.75*Math.min(i,s),4),this.width=this.direction?i:this.streetSize,this.depth=this.direction?this.streetSize:s}display(){if(.5<Rt(p[15]))return[];var t=new THREE.BoxBufferGeometry(this.width,.5,this.depth),e=new THREE.MeshStandardMaterial({color:O(this.color)});const i=new THREE.Mesh(t,e),s=[];_(this.x-this.width\/2,1.25,this.z-this.depth\/2,this.width,this.depth,.25,s),i.receiveShadow=!0,i.castShadow=!0,i.position.x=this.x,i.position.y=1.25,i.position.z=this.z,y.add(i);var h=Math.max(this.width,this.depth)\/12;let o=h;for(;o<=11*h;){var n={x:this.x+(this.direction?o-this.width\/2:0),y:.5,z:this.z+(this.direction?0:o-this.depth\/2),width:1,height:1,depth:1,color:O(this.color)};s.push(n);n=new THREE.Color(n.color);G.push(n.r),G.push(n.g),G.push(n.b),o+=h}return s}}class U{constructor(t,e,i,s,h,o){this.rainCells=h,this.x=t,this.y=e,this.z=i,this.rainDensity=o,this.rainGeo=new THREE.BufferGeometry,this.particles=[],this.scale=s,this.orthoRainSize=2,this.perspectiveRainSize=.2,this.snowTimeToRepeat=5,this.rainTimeToRepeat=1,this.timeToRepeat=et.weather.snow?this.snowTimeToRepeat:this.rainTimeToRepeat;s=Rt(p[14]);const n=new THREE.Color(et.weather.snow?15592941:s<.1?O():11591423);.1<=s&&n.lerp(new THREE.Color(et.sun.skyColor),.25),this.rainMaterial=new THREE.PointsMaterial({color:n,size:a?this.orthoRainSize:this.perspectiveRainSize,transparent:!0,opacity:et.weather.snow?.8:.4}),this.addParticles(),this.updateGeometry(),this.rain=new THREE.Points(this.rainGeo,this.rainMaterial),y.add(this.rain)}updateSize(){this.rainMaterial.size=a?this.orthoRainSize:this.perspectiveRainSize,this.rainMaterial.needsUpdate=!0}addParticles(){for(let t=0;t<Object.keys(this.rainCells).length*this.rainDensity;t++){var e=T(this.rainCells)[\"position\"],i=e[1]*this.scale+this.y-this.scale\/2,s=new THREE.Vector3(e[0]*this.scale+this.x+R()*this.scale\/2,i-l(Math.pow(R(),2),0,1,0,i),e[2]*this.scale+this.z+R()*this.scale\/2),h=i-s.y,e=2*i\/Math.pow(this.timeToRepeat,2);this.particles.push({initY:i,position:s,particalAcceleration:e,timeElapsed:Math.sqrt(2*h\/e),visible:s.y>et.weather.flood.waterDepth})}}updateGeometry(){const t=[];for(var e of this.particles)e.visible&&t.push(e.position.x,e.position.y,e.position.z);this.rainGeo.setAttribute(\"position\",new THREE.Float32BufferAttribute(t,3)),this.rainGeo.attributes.position.needsUpdate=!0}updateParticles(t){for(var e of this.particles){var i=Math.sqrt(2*e.initY\/e.particalAcceleration);e.timeElapsed+=t;var s=.5*e.particalAcceleration*Math.pow(e.timeElapsed,2);e.timeElapsed>=i?(i=(e.timeElapsed-i)%i,e.position.y=e.initY-.5*e.particalAcceleration*Math.pow(i,2),e.timeElapsed=i,e.visible=e.position.y>et.weather.flood.waterDepth):(e.position.y=e.initY-s,e.visible=e.position.y>et.weather.flood.waterDepth)}}step(t){this.updateParticles(t),this.updateGeometry()}}class q{constructor(){this.sunX,this.sunY;var t=Rt(p[2]);t<.4?(this.sunX=+n\/24,this.sunY=23*n\/24,this.directionalColor=16250578,this.groundColor=16757627,this.skyColor=11519487):t<.6?(this.sunX=n,this.sunY=n\/2,this.directionalColor=16700785,this.groundColor=12004412,this.skyColor=16700785):t<.8?(this.sunX=-n,this.sunY=n\/2,this.directionalColor=16761159,this.skyColor=12730432,this.groundColor=7479690,this.skyColor=13916024,this.groundColor=9455270,$=Math.PI):t<.9?(this.sunX=0,this.sunY=n,this.directionalColor=16777215,this.groundColor=16777215,this.skyColor=16777215):(this.sunX=+n\/24,this.sunY=23*n\/24,this.directionalColor=11250572,this.skyColor=5532607,this.groundColor=3495352),X.lerp(new THREE.Color(this.skyColor),.5),X.lerp(new THREE.Color(0),.2),B.setClearColor(X);const e=new THREE.DirectionalLight(this.directionalColor,.7);t=new THREE.HemisphereLight(this.skyColor,this.groundColor,.65);e.castShadow=!0,e.target.updateMatrixWorld(),e.shadow.camera.near=.1,e.shadow.camera.far=2*n,e.shadow.camera.left=-n,e.shadow.camera.right=n,e.shadow.camera.top=n,e.shadow.camera.bottom=-n,e.shadow.mapSize.width=4096,e.shadow.mapSize.height=4096,e.position.x=this.sunX,e.position.y=this.sunY,y.add(t),y.add(e)}}class V{constructor(t,e,i,s,h,o=150){this.x=t,this.y=e,this.z=i,this.position=[t,e,i],this.width=s,this.depth=h,this.resolution=o,this.cells={},this.rainCells={},this.cloudLayers=0,this.rain,this.padding=.1,this.blockSize=(this.width-this.padding)\/this.resolution,this.lowBound,this.highBound,this.shouldRain=!1,this.snow=!1,this.rainDensity=0,this.flood,this.cloudUuid,this.fog,this.flash=new THREE.PointLight(404873,0,n,2),this.create()}decideWeather(){var t=g;t<.4?(this.lowBound=0,this.highBound=0):t<.6?(this.lowBound=.32,this.highBound=.34,this.cloudLayers=Math.floor(L(1,3)),t<.45&&(this.shouldRain=!0)):t<.8?(this.lowBound=.4,this.highBound=.5,this.cloudLayers=Math.floor(L(2,5)),t<.7&&(this.shouldRain=!0)):(this.lowBound=.4,this.highBound=.6,this.cloudLayers=Math.floor(L(3,6)),t<.95&&(this.shouldRain=!0,.9<t&&(this.lightning=!0))),this.shouldRain&&(this.rainDensity=(e=[.04,.07,.11])[Math.floor(e.length*R())]),Rt(p[4])<.1&&(this.snow=!0,this.lightning=!1),this.lightning&&y.add(this.flash),this.flood=new K(0,0,n-.05,n-.05,this.snow),Rt(p[5])<.125&&(this.fog=!0,y.fog=new THREE.FogExp2(X,.005));var e=Rt(p[16]);this.cloudFallOff=e<.3?(t,e,i)=>{e=e<this.resolution\/2?e:this.resolution-e,i=i<this.resolution\/2?i:this.resolution-i,i=Math.min(l(Math.pow(Math.min(e,i),1\/3),0,Math.pow(this.resolution\/16,1\/3),0,1),1);return Math.min(l(t,this.resolution\/3,this.resolution\/2,1,.6),1)*i}:e<.6?t=>t<this.resolution\/3?Math.min(Math.max(l(t,this.resolution\/8,this.resolution\/3,0,1),0),1):Math.min(Math.max(l(t,this.resolution\/3,this.resolution\/2,1,0),0),1):e<.8?(t,e,i)=>{if(t<this.resolution\/3)return Math.min(Math.max(l(t,this.resolution\/8,this.resolution\/3,0,1),0),1);e=e<this.resolution\/2?e:this.resolution-e,i=i<this.resolution\/2?i:this.resolution-i;return Math.min(l(Math.pow(Math.min(e,i),1\/3),0,Math.pow(this.resolution\/4,1\/3),0,1),1)}:(t,e,i)=>{e=e<this.resolution\/2?e:this.resolution-e,i=i<this.resolution\/2?i:this.resolution-i;return Math.min(l(Math.pow(Math.min(e,i),1\/3),0,Math.pow(this.resolution\/4,1\/3),0,1),1)}}initWeather(){let o=0;for(let h=0;h<this.resolution;h++){let s=0;for(let i=0;i<this.cloudLayers;i++){let e=0;for(let t=0;t<this.resolution;t++){var n=Math.PI\/2\/(this.cloudLayers-1||1)*i,a=l(Math.cos(n),0,1,this.lowBound,this.highBound),n=Math.sqrt(Math.pow(h-this.resolution\/2,2)+Math.pow(t-this.resolution\/2,2)),n=this.cloudFallOff(n,h,t);(16*r(o,s,e)+8*r(2*o,2*s,2*e)+4*r(4*o,4*s,4*e)+2*r(8*o,8*s,8*e)+r(16*o,16*s,16*e))\/30<a*n&&(this.cells[this.key(h,i,t)]={position:[h,i,t],facesHidden:[!1,!1,!1,!1,!1,!1]}),e+=.05}s+=.05}o+=.05}this.prunedVoxels=this.pruneHiddenVoxels_(this.cells)}display(){const t=y.getObjectByProperty(\"uuid\",this.cloudUuid);t&&t.geometry&&t.material&&(t.geometry.dispose(),t.material.dispose(),y.remove(t)),this.makeRain(),this.makeClouds()}makeClouds(){const h=this.buildMeshDataFromVoxels(this.prunedVoxels);[THREE.FrontSide].forEach(t=>{const e=new THREE.MeshPhongMaterial({opacity:a?.4:.5,transparent:!0,color:\"#ffffff\",side:t});e.depthWrite=!1;const i=new THREE.BufferGeometry,s=new THREE.Mesh(i,e);this.cloudUuid=s.uuid,i.setAttribute(\"position\",new THREE.Float32BufferAttribute(h.positions,3)),i.setAttribute(\"normal\",new THREE.Float32BufferAttribute(h.normals,3)),i.setIndex(new THREE.BufferAttribute(h.indices,1)),i.attributes.position.needsUpdate=!0,i.attributes.normal.needsUpdate=!0,s.receiveShadow=!0,s.castShadow=!0,y.add(s)})}makeRain(){0<Object.keys(this.rainCells).length&&this.shouldRain&&!this.rain&&(this.rain=new U(this.x,this.y,this.z,this.blockSize,this.rainCells,this.rainDensity))}step(t){this.rain&&(this.rain.step(t),.99<R()||100<this.flash.power?(this.flash.power<100&&(t=T(this.rainCells)[\"position\"],this.flash.position.set(t[0]*this.blockSize-this.width\/2,this.y+t[1]*this.blockSize,t[2]*this.blockSize-this.depth\/2)),this.flash.power=50+500*R()):this.flash.power=0)}key(t,e,i){return t+\".\"+e+\".\"+i}pruneHiddenVoxels_(i){const t={};for(var s in i){const n=i[s];var h=[this.key(n.position[0]+1,n.position[1],n.position[2]),this.key(n.position[0]-1,n.position[1],n.position[2]),this.key(n.position[0],n.position[1]+1,n.position[2]),this.key(n.position[0],n.position[1]-1,n.position[2]),this.key(n.position[0],n.position[1],n.position[2]+1),this.key(n.position[0],n.position[1],n.position[2]-1)];let e=!1;for(let t=0;t<6;++t){var o=h[t]in i;(n.facesHidden[t]=o)||(e=!0,3==t&&(this.rainCells[s]=n))}e&&(t[s]=n)}return t}buildMeshDataFromVoxels(t){const e={positions:[],normals:[],indices:[]};for(var i in t){var s=t[i];for(let t=0;t<6;++t)if(!s.facesHidden[t]){var h=e.positions.length\/3;const r=[...this.geometries_[t].attributes.position.array];for(let e=0;e<3;++e)for(let t=0;t<4;++t)r[3*t+e]+=s.position[e]*this.blockSize+this.position[e]+this.blockSize\/2+this.padding\/2;e.positions.push(...r),e.normals.push(...this.geometries_[t].attributes.normal.array);const l=[...this.geometries_[t].index.array];for(let t=0;t<l.length;++t)l[t]+=h;e.indices.push(...l)}}const o=new Float32Array(4*e.positions.length),n=new Float32Array(4*e.normals.length),a=new Uint32Array(4*e.indices.length);return o.set(e.positions,0),n.set(e.normals,0),a.set(e.indices,0),{positions:e.positions,normals:n,indices:a}}create(){var t=this.blockSize;const e=new THREE.PlaneBufferGeometry(t,t);e.rotateY(Math.PI\/2),e.translate(t\/2,0,0);const i=new THREE.PlaneBufferGeometry(t,t);i.rotateY(-Math.PI\/2),i.translate(-t\/2,0,0);const s=new THREE.PlaneBufferGeometry(t,t);s.rotateX(-Math.PI\/2),s.translate(0,t\/2,0);const h=new THREE.PlaneBufferGeometry(t,t);h.rotateX(Math.PI\/2),h.translate(0,-t\/2,0);const o=new THREE.PlaneBufferGeometry(t,t);o.translate(0,0,t\/2);const n=new THREE.PlaneBufferGeometry(t,t);n.rotateY(Math.PI),n.translate(0,0,-t\/2),this.geometries_=[e,i,s,h,o,n]}}class K{constructor(t,e,i,s,h){if(this.x=t,this.z=e,this.width=i,this.depth=s,this.waterDepth=0,this.snow=h,this.snowHeight=0,.95<Rt(p[6])&&(this.waterDepth=tt.type===Q.MONOLITH?L(6.5,10):L(1,6)),(!et.weather.shouldRain||this.snow)&&0<this.waterDepth&&Rt(p[7])<.5&&(this.frozen=!0,this.waterDepth=tt.type===Q.MONOLITH?L(6.5,10):L(1,4)),0<this.waterDepth){var o=new THREE.BoxBufferGeometry(this.width,this.waterDepth,this.depth);const n=new THREE.MeshPhongMaterial({transparent:!0,opacity:this.frozen?.8:.5});n.depthWrite=!1;const a=new THREE.Mesh(o,n);a.position.set(this.x,this.waterDepth\/2,this.z),y.add(a)}if(this.snow&&(0===this.waterDepth||this.frozen)){this.snowHeight=L(.06,.1);h=new THREE.BoxBufferGeometry(this.width,this.snowHeight,this.depth),o=new THREE.MeshPhongMaterial;const r=new THREE.Mesh(h,o);r.receiveShadow=!0,r.position.set(this.x,this.waterDepth+this.snowHeight\/2,this.z),y.add(r)}}}const Q={TRADITONAL:\"traditional\",SHORT:\"short\",TALL:\"tall\",BIGGER_IN_CENTER:\"biggerInCenter\",AGRIDUSTRIAL:\"agridustrial\",SMALLER_IN_CENTER:\"smallerInCenter\",MONOLITH:\"monolith\",CHAOS:\"chaos\",PETE_REPEAT:\"peteRepeat\"};function J(t,e,i,s,h=!0){s=e+s;const o=h?Math.min:Math.max;i=o(t,0,-(t+i)),s=o(e,0,-s);return Math.sqrt(i*i+s*s)}let $=0;const tt=new class{constructor(){this.typePercentages=[.16,.3025,.445,.5625,.68,.7725,.865,.9325,1],this.decideType(),this.biomes={streetSizeGenerator:{traditional:t=>5<t?.5:0===t?L(2,4):1,agridustrial:t=>0===t&&R()<.8?L(2,6):L(.05,.3),monolith:t=>0,biggerInCenter:t=>5<t?.5:0===t?2:1,smallerInCenter:t=>5<t?.5:0===t?2:1,short:t=>0===t?1:.5,tall:t=>0===t?1.9:1,chaos:t=>L(.2,1),peteRepeat:t=>5<t?.5:0===t?L(2,4):1},streetGenerationChances:{traditional:(t,e,i,s,h,o)=>{var n=1-Math.pow(h\/8,2),h=.95*n\/(i+s);return{splitWidthChance:h*i,splitDepthChance:h*s,splitRepeatChance:.05*n,splitChoices:[.25,.5,.75],numRepetitionsX:Math.max(Math.floor(L(1,Math.min(i\/(k+o),6))),1),numRepetitionsZ:Math.max(Math.floor(L(1,Math.min(s\/(k+o),6))),1)}},agridustrial:(t,e,i,s,h,o)=>{var n=.84\/(i+s);return{splitWidthChance:n*i,splitDepthChance:n*s,splitRepeatChance:.03,splitChoices:[.25,.5,.75],numRepetitionsX:Math.max(Math.floor(L(1,Math.min(i\/(k+o),6))),1),numRepetitionsZ:Math.max(Math.floor(L(1,Math.min(s\/(k+o),6))),1)}},monolith:(t,e,i,s,h,o)=>({splitWidthChance:0,splitDepthChance:0,splitRepeatChance:0,splitChoices:[.25,.5,.75],numRepetitionsX:Math.max(Math.floor(L(1,Math.min(i\/(k+o),6))),1),numRepetitionsZ:Math.max(Math.floor(L(1,Math.min(s\/(k+o),6))),1)}),biggerInCenter:(t,e,i,s,h,o)=>{var n=1-Math.pow(h\/8,2),a=(4<h?.95*n:n)\/(i+s);return{splitWidthChance:a*i,splitDepthChance:a*s,splitRepeatChance:4<h?.05*n:0,splitChoices:[.25,.5,.75],numRepetitionsX:Math.max(Math.floor(L(1,Math.min(i\/(k+o),6))),1),numRepetitionsZ:Math.max(Math.floor(L(1,Math.min(s\/(k+o),6))),1)}},smallerInCenter:(t,e,i,s,h,o)=>{var n=1-Math.pow(h\/8,2),a=(4<h?.95*n:n)\/(i+s);return{splitWidthChance:a*i,splitDepthChance:a*s,splitRepeatChance:4<h?.05*n:0,splitChoices:[.25,.5,.75],numRepetitionsX:Math.max(Math.floor(L(1,Math.min(i\/(k+o),6))),1),numRepetitionsZ:Math.max(Math.floor(L(1,Math.min(s\/(k+o),6))),1)}},short:(t,e,i,s,h,o)=>{var n=1-Math.pow(h\/8,2),h=.95*n\/(i+s);return{splitWidthChance:h*i,splitDepthChance:h*s,splitRepeatChance:.05*n,splitChoices:[.25,.5,.75],numRepetitionsX:Math.max(Math.floor(L(1,Math.min(i\/(k+o),6))),1),numRepetitionsZ:Math.max(Math.floor(L(1,Math.min(s\/(k+o),6))),1)}},tall:(t,e,i,s,h,o)=>{var n=1-Math.pow(h\/8,2),h=.95*n\/(i+s);return{splitWidthChance:h*i,splitDepthChance:h*s,splitRepeatChance:.05*n,splitChoices:[.25,.5,.75],numRepetitionsX:Math.max(Math.floor(L(1,Math.min(i\/(k+o),6))),1),numRepetitionsZ:Math.max(Math.floor(L(1,Math.min(s\/(k+o),6))),1)}},chaos:(t,e,i,s,h,o)=>({splitWidthChance:.49,splitDepthChance:.49,splitRepeatChance:0,splitChoices:[.1,.2,.3,.4,.5,.6,.7,.8,.9],numRepetitionsX:Math.max(Math.floor(L(1,Math.min(i\/(k+o),6))),1),numRepetitionsZ:Math.max(Math.floor(L(1,Math.min(s\/(k+o),6))),1)}),peteRepeat:(t,e,i,s,h,o)=>({splitWidthChance:.3,splitDepthChance:.3,splitRepeatChance:.3,splitChoices:[.25,.5,.75],numRepetitionsX:Math.max(Math.floor(L(1,Math.min(i\/(k+o),6))),1),numRepetitionsZ:Math.max(Math.floor(L(1,Math.min(s\/(k+o),6))),1)})},blockSplitChances:{traditional:(t,e,i,s,h)=>({splitWidthChance:.33,splitDepthChance:.33,splitRepeatChance:.1,splitWhere:L(.2,.8),numRepetitionsX:Math.max(Math.floor(L(1,Math.min(i\/k,6))),1),numRepetitionsZ:Math.max(Math.floor(L(1,Math.min(s\/k,6))),1)}),agridustrial:(t,e,i,s,h)=>({splitWidthChance:.2,splitDepthChance:.2,splitRepeatChance:.6,splitWhere:L(.2,.8),numRepetitionsX:Math.max(Math.floor(L(1,Math.min(i\/k,6))),1),numRepetitionsZ:Math.max(Math.floor(L(1,Math.min(s\/k,6))),1)}),monolith:(t,e,i,s,h)=>({splitWidthChance:0,splitDepthChance:0,splitRepeatChance:0,splitWhere:0,numRepetitionsX:Math.max(Math.floor(L(1,Math.min(i\/k,6))),1),numRepetitionsZ:Math.max(Math.floor(L(1,Math.min(s\/k,6))),1)}),biggerInCenter:(t,e,i,s,h)=>{t=J(t,e,i,s),e=Math.min(l(t,0,n\/3,0,1),1),t=(5<h?.85*e:+e)\/(i+s);return{splitWidthChance:t*i,splitDepthChance:t*s,splitRepeatChance:5<h?.05*e:0,splitWhere:L(.2,.8),numRepetitionsX:Math.max(Math.floor(L(1,Math.min(i\/k,6))),1),numRepetitionsZ:Math.max(Math.floor(L(1,Math.min(s\/k,6))),1)}},smallerInCenter:(t,e,i,s,h)=>{t=J(t,e,i,s,!1),e=Math.min(Math.max(l(t,0,n\/2,2,0),0),1),t=(5<h?.95*e:+e)\/(i+s);return{splitWidthChance:t*i,splitDepthChance:t*s,splitRepeatChance:5<h?.05*e:0,splitWhere:L(.2,.8),numRepetitionsX:Math.max(Math.floor(L(1,Math.min(i\/k,6))),1),numRepetitionsZ:Math.max(Math.floor(L(1,Math.min(s\/k,6))),1)}},short:(t,e,i,s,h)=>({splitWidthChance:.33,splitDepthChance:.33,splitRepeatChance:.1,splitWhere:L(.2,.8),numRepetitionsX:Math.max(Math.floor(L(1,Math.min(i\/k,6))),1),numRepetitionsZ:Math.max(Math.floor(L(1,Math.min(s\/k,6))),1)}),tall:(t,e,i,s,h)=>({splitWidthChance:.33,splitDepthChance:.33,splitRepeatChance:.1,splitWhere:L(.2,.8),numRepetitionsX:Math.max(Math.floor(L(1,Math.min(i\/k,6))),1),numRepetitionsZ:Math.max(Math.floor(L(1,Math.min(s\/k,6))),1)}),chaos:(t,e,i,s,h)=>{h=3<h?.85:1;return{splitWidthChance:h\/2,splitDepthChance:h\/2,splitRepeatChance:0,splitWhere:L(.1,.9),numRepetitionsX:Math.max(Math.floor(L(1,Math.min(i\/k,6))),1),numRepetitionsZ:Math.max(Math.floor(L(1,Math.min(s\/k,6))),1)}},peteRepeat:(t,e,i,s,h)=>({splitWidthChance:.3,splitDepthChance:.3,splitRepeatChance:.3,splitWhere:L(.2,.8),numRepetitionsX:Math.max(Math.floor(L(1,Math.min(i\/k,6))),1),numRepetitionsZ:Math.max(Math.floor(L(1,Math.min(s\/k,6))),1)})},buildingSplitChances:{traditional:(t,e,i,s,h)=>({splitWidthChance:.33,splitDepthChance:.33,splitRepeatChance:.1,splitWhere:L(.2,.8),createLevelChance:1,numRepetitionsX:Math.floor(L(1,Math.min(i\/k,6)))||1,numRepetitionsZ:Math.floor(L(1,Math.min(s\/k,6)))||1}),agridustrial:(t,e,i,s,h)=>({splitWidthChance:.8,splitDepthChance:.05,splitRepeatChance:.1,splitWhere:.2,createLevelChance:1,numRepetitionsX:Math.floor(L(1,Math.min(i\/k,6)))||1,numRepetitionsZ:Math.floor(L(1,Math.min(s\/k,6)))||1}),monolith:(t,e,i,s,h)=>({splitWidthChance:0===h?0:.2,splitDepthChance:0===h?0:.2,splitRepeatChance:0===h?0:.05,splitWhere:L(.4,.6),createLevelChance:1,numRepetitionsX:Math.floor(L(1,Math.min(i\/k,6)))||1,numRepetitionsZ:Math.floor(L(1,Math.min(s\/k,6)))||1}),biggerInCenter:(t,e,i,s,h)=>{e=J(t,e,i,s,!1);return{splitWidthChance:.33,splitDepthChance:.33,splitRepeatChance:.05,splitWhere:L(.2,.8),createLevelChance:l(e,0,n\/2,1.2,0),numRepetitionsX:Math.floor(L(1,Math.min(i\/k,6)))||1,numRepetitionsZ:Math.floor(L(1,Math.min(s\/k,6)))||1}},smallerInCenter:(t,e,i,s,h)=>{e=J(t,e,i,s,!1);return{splitWidthChance:.33,splitDepthChance:.33,splitRepeatChance:.05,splitWhere:L(.2,.8),createLevelChance:l(e,0,n\/3,0,1.2),numRepetitionsX:Math.floor(L(1,Math.min(i\/k,6)))||1,numRepetitionsZ:Math.floor(L(1,Math.min(s\/k,6)))||1}},short:(t,e,i,s,h)=>({splitWidthChance:.33,splitDepthChance:.33,splitRepeatChance:.1,splitWhere:L(.2,.8),createLevelChance:1,numRepetitionsX:Math.floor(L(1,Math.min(i\/k,6)))||1,numRepetitionsZ:Math.floor(L(1,Math.min(s\/k,6)))||1}),tall:(t,e,i,s,h)=>({splitWidthChance:.33,splitDepthChance:.33,splitRepeatChance:.1,splitWhere:L(.2,.8),createLevelChance:1,numRepetitionsX:Math.floor(L(1,Math.min(i\/k,6)))||1,numRepetitionsZ:Math.floor(L(1,Math.min(s\/k,6)))||1}),chaos:(t,e,i,s,h)=>({splitWidthChance:.4,splitDepthChance:.4,splitRepeatChance:0,splitWhere:L(.2,.8),createLevelChance:1,numRepetitionsX:Math.floor(L(1,Math.min(i\/k,6)))||1,numRepetitionsZ:Math.floor(L(1,Math.min(s\/k,6)))||1}),peteRepeat:(t,e,i,s,h)=>({splitWidthChance:.3,splitDepthChance:.3,splitRepeatChance:.3,splitWhere:L(.2,.8),createLevelChance:1,numRepetitionsX:Math.floor(L(1,Math.min(i\/k,6)))||1,numRepetitionsZ:Math.floor(L(1,Math.min(s\/k,6)))||1})},buildingHeightGenerator:{traditional:(t,e,i,s,h,o)=>L(.2,1)*Math.min(Math.min(s,h),n\/40)*2,agridustrial:(t,e,i,s,h,o)=>L(.2,1)*Math.min(Math.min(s,h),n\/40)*2,monolith:(t,e,i,s,h,o)=>L(.2,1)*Math.min(Math.min(s,h),n\/40)*2,biggerInCenter:(t,e,i,s,h,o)=>{i=J(t,i,s,h,!1);return l(i,0,Math.sqrt(n*n+n*n),3,0)*Math.min(Math.min(s,h),n\/40)},smallerInCenter:(t,e,i,s,h,o)=>{i=J(t,i,s,h,!1);return l(i,0,Math.sqrt(n*n+n*n),.5,3)*Math.min(Math.min(s,h),n\/40)},short:(t,e,i,s,h,o)=>L(.2,1)*Math.min(Math.min(s,h),n\/40)*1,tall:(t,e,i,s,h,o)=>L(.2,1)*Math.min(Math.min(s,h),n\/40)*3.2,chaos:(t,e,i,s,h,o)=>L(L(.1,.3),L(1,1.4))*Math.min(Math.min(s,h),n\/40)*L(1.5,3),peteRepeat:(t,e,i,s,h,o)=>L(.2,1)*Math.min(Math.min(s,h),n\/40)*2}},this.attributes=this.initBiome()}initBiome(){const e={};var i=Object.keys(this.biomes);for(let t=0;t<i.length;t++){var s=i[t];e[s]=this.biomes[s][this.type]}return e}decideType(){this.type=I(11,this.typePercentages,Object.values(Q))}},et=new class{constructor(t,e,i,s){this.x=t-i\/2,this.z=e-s\/2,this.width=i,this.depth=s,this.weather,this.sun,this.create()}display(){this.sun=new q,this.weather=new V(this.x,60,this.z,this.width,this.depth),this.weather.decideWeather(),this.weather.initWeather(),this.weather.display();const t=new N(this.x,this.z,this.width,this.depth);t.display();var e=t.boxes;const i=new THREE.BufferGeometry,s=[],h=[],o=[];for(let t=0;t<5;++t){s.push(...this.geometries_[t].attributes.position.array);var n=s.length\/3;h.push(...this.geometries_[t].attributes.normal.array);const u=[...this.geometries_[t].index.array];for(let t=0;t<u.length;++t)u[t]+=n-4;o.push(...u)}const a=new THREE.MeshPhongMaterial;i.setAttribute(\"instanceColor\",new THREE.InstancedBufferAttribute(new Float32Array(G),3)),i.setAttribute(\"position\",new THREE.Float32BufferAttribute(s,3)),i.setAttribute(\"normal\",new THREE.Float32BufferAttribute(h,3)),i.setIndex(new THREE.BufferAttribute(new Uint32Array(o),1));const r=[\"attribute vec3 instanceColor;\",\"varying vec3 vInstanceColor;\",\"#include <common>\"].join(\"\\n\"),l=[\"#include <begin_vertex>\",\"\\tvInstanceColor = instanceColor;\"].join(\"\\n\"),p=[\"varying vec3 vInstanceColor;\",\"#include <common>\"].join(\"\\n\"),c=[\"vec4 diffuseColor = vec4( diffuse * vInstanceColor, opacity );\"].join(\"\\n\");a.onBeforeCompile=function(t){t.vertexShader=t.vertexShader.replace(\"#include <common>\",r).replace(\"#include <begin_vertex>\",l),t.fragmentShader=t.fragmentShader.replace(\"#include <common>\",p).replace(\"vec4 diffuseColor = vec4( diffuse, opacity );\",c)};const d=new THREE.InstancedMesh(i,a,e.length);for(let t=0;t<e.length;t++){const m=new THREE.Matrix4,M=new THREE.Vector3;M.x=e[t].x,M.y=e[t].y,M.z=e[t].z;const w=new THREE.Vector3;w.x=e[t].width,w.y=e[t].height,w.z=e[t].depth,m.compose(M,new THREE.Quaternion,w),d.setMatrixAt(t,m)}y.add(d),d.receiveShadow=!0,d.castShadow=!0}step(t){this.weather.step(t)}create(){const t=new THREE.PlaneBufferGeometry(1,1);t.rotateY(Math.PI\/2),t.translate(.5,0,0);const e=new THREE.PlaneBufferGeometry(1,1);e.rotateY(-Math.PI\/2),e.translate(-.5,0,0);const i=new THREE.PlaneBufferGeometry(1,1);i.rotateX(-Math.PI\/2),i.translate(0,.5,0);const s=new THREE.PlaneBufferGeometry(1,1);s.translate(0,0,.5);const h=new THREE.PlaneBufferGeometry(1,1);h.rotateY(Math.PI),h.translate(0,0,-.5),this.geometries_=[t,e,i,s,h]}}(0,0,n,n);et.display();const it=[Math.PI\/8,Math.PI\/6,Math.PI\/4,Math.PI\/3];c===n\/4&&it.shift();const st=it[Math.floor(l(Rt(p[8]),0,1,0,it.length-1e-9))];let ht=st;o=[Math.PI\/4,Math.PI\/8,Math.PI\/16,Math.PI\/64,-Math.PI\/4,-Math.PI\/8,-Math.PI\/16,-Math.PI\/64];const ot=o[Math.floor(l(Rt(p[11]),0,1,0,o.length-1e-9))]+$;let nt=ot;function at(t){t=d+t\/10;t<0||t>1.5*n||(d=t,wt(),rt())}function rt(){et.weather.fog&&(y.fog.density=a?.005:l(Math.pow(d,1\/3),0,Math.pow(1.5*n,1\/3),.025,.006))}window.addEventListener(\"resize\",function(){i=window.innerWidth\/window.innerHeight,u.aspect=i,m.aspect=i,wt(),u.updateProjectionMatrix(),m.updateProjectionMatrix(),B.setSize(window.innerWidth,window.innerHeight)},!1),window.addEventListener(\"wheel\",t=>{at(t.deltaY)});let lt=0,pt=0,ct=!1,dt=!0;const ut=[];let mt;function Mt(e){return t=>{e&&(t.pointerId=e),function(e){for(let t=0;t<ut.length;t++)if(ut[t].pointerId==e.pointerId){ut.splice(t,1);break}}(t),ut.length<2&&(mt=-1),ct&&(lt=0,pt=0,ct=!1)}}function wt(){m.left=-d*i,m.right=d*i,m.top=d,m.bottom=-d,m.updateProjectionMatrix()}window.addEventListener(\"pointerdown\",t=>{t.button||(ut.push(t),lt=t.offsetX,pt=t.offsetY,ct=!0)}),window.addEventListener(\"pointermove\",e=>{if(ct){for(let t=0;t<ut.length;t++)if(e.pointerId==ut[t].pointerId){ut[t]=e;break}var t;2===ut.length?(t=Math.abs(ut[0].clientX-ut[1].clientX),0<mt&&at(mt-t),mt=t):1===ut.length&&((t=ht-(pt-e.offsetY)\/300)<Math.PI\/2&&t>-Math.PI\/2&&(ht=t),nt-=(lt-e.offsetX)\/300,lt=e.offsetX,pt=e.offsetY)}}),window.addEventListener(\"pointerup\",Mt()),window.addEventListener(\"pointercancel\",Mt()),window.addEventListener(\"pointerout\",Mt()),window.addEventListener(\"pointerleave\",Mt()),window.addEventListener(\"contextmenu\",Mt(1)),window.addEventListener(\"keydown\",function(t){switch(t.key){case\"p\":dt=!dt;break;case\"r\":d=c,wt(),nt=ot,ht=st,rt();break;case\"c\":M=a?u:m,a=!a,y.camera=M,et.weather.display(),et.weather.rain?.updateSize(),rt();break;case\"z\":ht=Math.PI\/4,nt=Math.PI\/4+$,d=a?+n:1.4*n,rt(),wt();break;case\"t\":A?B.setClearColor(X,1):B.setClearColor(0,0),A=!A;break;case\"1\":B.setPixelRatio(.25);break;case\"2\":B.setPixelRatio(.75);break;case\"3\":B.setPixelRatio(.9);break;case\"4\":B.setPixelRatio(1)}});let ft=new THREE.Clock;function Rt(t){return l(t,0,255,0,1)}requestAnimationFrame(function t(){var e=ft.getDelta(),i=a?h:d;dt&&(nt+=e*(2*Math.PI\/240)),et.step(e),M.position.x=Math.cos(nt)*Math.cos(ht)*i,M.position.y=Math.sin(ht)*i,M.position.z=Math.sin(nt)*Math.cos(ht)*i,M.lookAt(0,0,0),B.render(y,M),requestAnimationFrame(t)});"
}